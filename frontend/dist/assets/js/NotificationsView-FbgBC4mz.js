import{_ as Q,r as p,c as b,a4 as V,o as W,b as v,d as a,e as n,w as r,j as X,P as Z,J as C,ag as y,H as m,E as Y,N as ee,O as te,n as se,L as u,k as ae,l as c,G as g,h as R,aK as oe,eq as le,I as $,K as ne,X as ie,aJ as M,aO as re,ay as ce,aP as T,U as ue,Z as de,af as pe}from"./index-Da7ZqcH5.js";/* empty css                *//* empty css                   *//* empty css               */import"./scrollbar-PN-ehNXN.js";import{s as ve,f as me}from"./positionedConfirm-C6ixQw3s.js";import{d as _e,c as fe,m as ye,e as ge,b as ke}from"./notification-7HEdQPIl.js";import{v as he}from"./directive-iqmOBkSf.js";import{E as Ce}from"./index-DSEo_ZHY.js";import"./vnode-DsZHVpXe.js";import"./index-mDFjMy5P.js";import"./castArray-DVWVVBpp.js";import"./isEqual-HUGtL056.js";import"./_Uint8Array-CNK7Frb1.js";import"./index-k6BulDX8.js";import"./index-lPpvXrw4.js";import"./index-CZyikzse.js";import"./index-ViZWhRvA.js";import"./index-BJ8ssZSI.js";import"./index-Chbwi6h6.js";import"./index-BwTCsBpr.js";import"./index-Ddj3Fd5B.js";import"./index-R92uOlC6.js";import"./index-DuvIoQvO.js";import"./index-BLAWzDFp.js";const we={class:"notifications-view"},Ne={class:"page-header"},xe={class:"header-content"},be={class:"header-actions"},Re={class:"notifications-content"},$e={class:"filter-section"},Ae={class:"filter-tabs"},Ee={class:"filter-actions"},ze={key:0,class:"notifications-list"},Ve=["onClick"],Me={class:"notification-content"},Te={class:"notification-header"},Ie={class:"notification-title"},Pe={class:"notification-meta"},Ue={class:"notification-time"},Be={class:"notification-description"},De={class:"notification-actions"},Se={key:0,class:"notification-status"},Le={key:1,class:"empty-state"},je={class:"empty-icon"},Je={key:2,class:"pagination-section"},Ke={__name:"NotificationsView",setup(Oe){const I=ae(),o=p("all"),_=p(""),f=p(1),w=p(10),N=p(!1),i=p([]),k=p(0),A=b(()=>i.value.filter(t=>!t.isRead).length),P=b(()=>i.value),U=b(()=>i.value),B=t=>({comment:pe,system:de,user:ue,like:T,success:T,warning:ce,info:re})[t]||M,D=t=>({comment:"primary",system:"info",user:"success",like:"success",success:"success",warning:"warning",info:"info"})[t]||"info",E=t=>({comment:"评论",system:"系统",user:"用户",like:"点赞",success:"成功",warning:"警告",info:"信息"})[t]||"通知",S=()=>o.value==="unread"?"所有通知都已阅读":o.value!=="all"?`暂无${E(o.value)}通知`:_.value?"没有找到匹配的通知":"暂时没有任何通知",L=async t=>{try{await ke(t.id),t.isRead=!0,u.success("已标记为已读")}catch(e){console.error("标记已读失败:",e),u.error("标记已读失败")}},j=async()=>{try{await ye(),i.value.forEach(t=>t.isRead=!0),u.success("所有通知已标记为已读")}catch(t){console.error("标记所有已读失败:",t),u.error("标记所有已读失败")}},J=async(t,e)=>{try{await me("这条通知",e),await ge(t.id);const l=i.value.findIndex(d=>d.id===t.id);l>-1&&(i.value.splice(l,1),u.success("通知已删除"))}catch(l){l!=="cancel"&&(console.error("删除通知失败:",l),u.error("删除通知失败"))}},K=async t=>{try{await ve("确定要清空所有通知吗？此操作不可恢复。","确认清空",t),await fe(),i.value=[],u.success("所有通知已清空")}catch(e){e!=="cancel"&&(console.error("清空通知失败:",e),u.error("清空通知失败"))}},z=t=>{t.actionUrl&&I.push(t.actionUrl)},O=t=>{f.value=t},x=async()=>{try{N.value=!0;const t={page:f.value-1,size:w.value};o.value!=="all"&&(t.type=o.value),_.value&&(t.keyword=_.value);const l=(await _e(t)).data||{};i.value=l.content||[],k.value=l.total||0,console.log("通知数据加载成功:",i.value,"总数:",k.value)}catch(t){console.error("加载通知失败:",t),u.error("加载通知失败")}finally{N.value=!1}};return V([o,_],()=>{f.value=1,x()}),V(f,()=>{x()}),W(()=>{x()}),(t,e)=>{const l=se,d=X,q=Y,F=ie,G=Ce,H=he;return c(),v("div",we,[a("div",Ne,[a("div",xe,[e[9]||(e[9]=a("div",{class:"title-section"},[a("h1",null,"通知中心"),a("p",null,"管理您的所有通知消息")],-1)),a("div",be,[n(d,{type:"primary",onClick:j,disabled:A.value===0},{default:r(()=>[n(l,null,{default:r(()=>[n(R(oe))]),_:1}),e[7]||(e[7]=g(" 全部标记已读 ",-1))]),_:1,__:[7]},8,["disabled"]),n(d,{onClick:e[0]||(e[0]=s=>K(s))},{default:r(()=>[n(l,null,{default:r(()=>[n(R(le))]),_:1}),e[8]||(e[8]=g(" 清空通知 ",-1))]),_:1,__:[8]})])])]),a("div",Re,[a("div",$e,[a("div",Ae,[a("div",{class:y(["tab-item",{active:o.value==="all"}]),onClick:e[1]||(e[1]=s=>o.value="all")}," 全部通知 ("+m(i.value.length)+") ",3),a("div",{class:y(["tab-item",{active:o.value==="unread"}]),onClick:e[2]||(e[2]=s=>o.value="unread")}," 未读通知 ("+m(A.value)+") ",3),a("div",{class:y(["tab-item",{active:o.value==="comment"}]),onClick:e[3]||(e[3]=s=>o.value="comment")}," 评论通知 ",2),a("div",{class:y(["tab-item",{active:o.value==="system"}]),onClick:e[4]||(e[4]=s=>o.value="system")}," 系统通知 ",2)]),a("div",Ee,[n(q,{modelValue:_.value,"onUpdate:modelValue":e[5]||(e[5]=s=>_.value=s),placeholder:"搜索通知...","prefix-icon":"Search",clearable:"",style:{width:"300px"}},null,8,["modelValue"])])]),P.value.length>0?Z((c(),v("div",ze,[(c(!0),v(ee,null,te(U.value,s=>(c(),v("div",{class:y(["notification-card",{unread:!s.isRead}]),key:s.id,onClick:h=>z(s)},[a("div",{class:y(["notification-avatar",s.type])},[n(l,null,{default:r(()=>[(c(),$(ne(B(s.type))))]),_:2},1024)],2),a("div",Me,[a("div",Te,[a("h3",Ie,m(s.title),1),a("div",Pe,[a("span",Ue,m(s.timeAgo||s.createdAt),1),n(F,{type:D(s.type),size:"small"},{default:r(()=>[g(m(E(s.type)),1)]),_:2},1032,["type"])])]),a("p",Be,m(s.content),1),a("div",De,[s.isRead?C("",!0):(c(),$(d,{key:0,size:"small",type:"primary",text:"",onClick:h=>L(s)},{default:r(()=>e[10]||(e[10]=[g(" 标记已读 ",-1)])),_:2,__:[10]},1032,["onClick"])),n(d,{size:"small",text:"",onClick:h=>J(s,h)},{default:r(()=>e[11]||(e[11]=[g(" 删除 ",-1)])),_:2,__:[11]},1032,["onClick"]),s.actionUrl?(c(),$(d,{key:1,size:"small",type:"primary",onClick:h=>z(s)},{default:r(()=>e[12]||(e[12]=[g(" 查看详情 ",-1)])),_:2,__:[12]},1032,["onClick"])):C("",!0)])]),s.isRead?C("",!0):(c(),v("div",Se,e[13]||(e[13]=[a("div",{class:"unread-indicator"},null,-1)])))],10,Ve))),128))])),[[H,N.value]]):(c(),v("div",Le,[a("div",je,[n(l,null,{default:r(()=>[n(R(M))]),_:1})]),e[14]||(e[14]=a("h3",null,"暂无通知",-1)),a("p",null,m(S()),1)])),k.value>w.value?(c(),v("div",Je,[n(G,{"current-page":f.value,"onUpdate:currentPage":e[6]||(e[6]=s=>f.value=s),"page-size":w.value,total:k.value,layout:"prev, pager, next, jumper, total",onCurrentChange:O},null,8,["current-page","page-size","total"])])):C("",!0)])])}}},ft=Q(Ke,[["__scopeId","data-v-53cd2e31"]]);export{ft as default};
