/* empty css             *//* empty css                  *//* empty css                 *//* empty css                  *//* empty css                *//* empty css                  *//* empty css               *//* empty css                           *//* empty css                         */import{r as a,p as e,c as l,a as t,Q as s,K as i,I as n,O as c,P as u,a6 as r,u as o,M as d,al as v,aD as m,o as p,H as h}from"./vue-B9wWIsxR.js";import{u as f}from"./index-di9GIa25.js";import{a6 as g,a7 as k,e as y,G as _,r as C,an as w,F as j,j as b,a8 as L,_ as x,m as z,a9 as A,E as I,aa as T,ab as V,$,a5 as H,U as M,ao as D}from"./element-plus-CXASJE3V.js";import{a as E}from"./article-Pn5uYJFo.js";import{c as S}from"./comment-DttPZ_iH.js";import{_ as U}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./utils-C28rWPR3.js";const Y={class:"tech-share-detail"},B={class:"container"},P={key:0,class:"loading"},O={key:1,class:"article-content"},R={class:"tech-header"},F={class:"breadcrumb"},G={class:"tech-category"},K={class:"title"},Q={class:"tech-meta"},q={class:"author-info"},J={class:"author-details"},N={class:"name"},W={class:"time"},X={class:"tech-stats"},Z={class:"stat-item"},aa={class:"stat-item"},ea={class:"stat-item"},la={class:"stat-item"},ta={key:0,class:"tech-tags"},sa={class:"tech-body"},ia={class:"content-wrapper"},na={class:"article-content"},ca=["innerHTML"],ua={class:"tech-sidebar"},ra={class:"tech-info-card"},oa={class:"tech-points"},da={key:0,class:"difficulty"},va={key:1,class:"tech-stack"},ma={class:"tech-tags"},pa={key:2,class:"read-time"},ha={class:"value"},fa={key:0,class:"related-articles"},ga={class:"related-list"},ka=["onClick"],ya=["src","alt"],_a={class:"related-content"},Ca={class:"tech-footer"},wa={class:"actions"},ja={class:"tech-comments-section"},ba={key:0,class:"comment-form"},La={class:"form-actions"},xa={key:1,class:"login-prompt"},za={class:"comments-list"},Aa={class:"comment-avatar"},Ia={class:"comment-content"},Ta={class:"comment-header"},Va={class:"username"},$a={class:"time"},Ha={class:"comment-text"},Ma={class:"comment-actions"},Da={key:0},Ea={key:2,class:"not-found"},Sa=U({__name:"TechShareDetail",setup(U){const Sa=m(),Ua=f(),Ya=a(!0),Ba=a(null),Pa=a([]),Oa=a([]),Ra=a(!1),Fa=a(""),Ga=a(!1),Ka=a=>T(a).format("YYYY-MM-DD HH:mm"),Qa=async()=>{var a;if(Ba.value)try{const e=Ba.value.slug||Ba.value.id,l=await S.getArticleComments(e),t=(null==(a=l.data)?void 0:a.content)||l.data||[];Pa.value=t.map(a=>({...a,isLiked:!1,likeCount:a.likeCount||0}))}catch(e){}},qa=async()=>{var a,e,l,t;try{let i=[];if(null==(e=null==(a=Ba.value)?void 0:a.tags)?void 0:e.length)try{const a=Ba.value.tags[0].slug,e=await E.getArticlesByTag(a,{page:0,size:5});i=(null==(l=e.data)?void 0:l.content)||e.data||[]}catch(s){}if(!i.length){const a=await E.getArticlesByCategory("tech",{page:0,size:5});i=(null==(t=a.data)?void 0:t.content)||a.data||[]}Oa.value=i.filter(a=>{var e;return a.id!==(null==(e=Ba.value)?void 0:e.id)}).slice(0,3)}catch(i){}},Ja=async()=>{if(Ua.isLoggedIn)try{Ra.value?(await E.unlikeArticle(Ba.value.id),Ba.value.likeCount--):(await E.likeArticle(Ba.value.id),Ba.value.likeCount++),Ra.value=!Ra.value}catch(a){I.error("操作失败")}else I.warning("请先登录")},Na=()=>{navigator.share?navigator.share({title:Ba.value.title,text:Ba.value.excerpt,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),I.success("链接已复制到剪贴板"))},Wa=()=>{I.success("收藏功能开发中...")},Xa=async()=>{if(Fa.value.trim()){Ga.value=!0;try{await S.createComment({articleId:Ba.value.id,content:Fa.value}),Fa.value="",I.success("评论发表成功"),await Qa()}catch(a){I.error("评论发表失败")}finally{Ga.value=!1}}else I.warning("请输入评论内容")};return e(()=>{(async()=>{var a;Ya.value=!0;try{const l=Sa.params.slug,t=await E.getArticleBySlug(l);if(Ba.value=t.data,Ua.isLoggedIn&&(null==(a=Ba.value)?void 0:a.id))try{const a=await E.isArticleLiked(Ba.value.id);Ra.value=!!a.data}catch(e){Ra.value=!1}await Promise.all([Qa(),qa()])}catch(l){Ba.value=null,I.error("加载技术文章失败，请稍后重试")}finally{Ya.value=!1}})()}),(a,e)=>{var m,f;const T=g,E=V,U=k,Sa=C,Qa=y,qa=_,Za=w,ae=b,ee=z,le=v("router-link"),te=A;return p(),l("div",Y,[t("div",B,[Ya.value?(p(),l("div",P,[s(T,{rows:12,animated:""})])):Ba.value?(p(),l("div",O,[t("header",R,[t("div",F,[s(U,{separator:"/"},{default:n(()=>[s(E,{to:"/"},{default:n(()=>e[4]||(e[4]=[d("首页",-1)])),_:1,__:[4]}),s(E,{to:"/tech-share"},{default:n(()=>e[5]||(e[5]=[d("技术分享",-1)])),_:1,__:[5]}),s(E,null,{default:n(()=>[d(c(Ba.value.title),1)]),_:1})]),_:1})]),t("div",G,[s(Qa,{type:"info",size:"large"},{default:n(()=>[s(Sa,null,{default:n(()=>[s(o($))]),_:1}),e[6]||(e[6]=d(" 技术分享 ",-1))]),_:1,__:[6]})]),t("h1",K,c(Ba.value.title),1),t("div",Q,[t("div",q,[s(qa,{src:null==(m=Ba.value.author)?void 0:m.avatar,size:48},{default:n(()=>{var a,e;return[d(c(null==(e=null==(a=Ba.value.author)?void 0:a.nickname)?void 0:e.charAt(0)),1)]}),_:1},8,["src"]),t("div",J,[t("div",N,c(null==(f=Ba.value.author)?void 0:f.nickname),1),t("div",W,c(Ka(Ba.value.publishedAt)),1)])]),t("div",X,[t("div",Z,[s(Sa,null,{default:n(()=>[s(o(H))]),_:1}),t("span",null,c(Ba.value.viewCount)+" 阅读",1)]),t("div",aa,[s(Sa,null,{default:n(()=>[s(o(j))]),_:1}),t("span",null,c(Ba.value.likeCount)+" 点赞",1)]),t("div",ea,[s(Sa,null,{default:n(()=>[s(o(M))]),_:1}),t("span",null,c(Ba.value.commentCount||0)+" 评论",1)]),t("div",la,[s(Sa,null,{default:n(()=>[s(o(x))]),_:1}),t("span",null,c(Ba.value.collectCount||0)+" 收藏",1)])])]),Ba.value.tags&&Ba.value.tags.length?(p(),l("div",ta,[(p(!0),l(u,null,r(Ba.value.tags,e=>(p(),h(Qa,{key:e.id,type:"primary",effect:"dark",size:"large",onClick:l=>a.$router.push(`/tag/${e.slug}`)},{default:n(()=>[s(Sa,null,{default:n(()=>[s(o(D))]),_:1}),d(" "+c(e.name),1)]),_:2},1032,["onClick"]))),128))])):i("",!0)]),t("main",sa,[t("div",ia,[t("div",na,[t("div",{class:"content",innerHTML:Ba.value.content},null,8,ca)]),t("aside",ua,[t("div",ra,[e[10]||(e[10]=t("h3",null,"技术要点",-1)),t("div",oa,[Ba.value.difficulty?(p(),l("div",da,[e[7]||(e[7]=t("span",{class:"label"},"难度等级：",-1)),s(Za,{modelValue:Ba.value.difficulty,"onUpdate:modelValue":e[0]||(e[0]=a=>Ba.value.difficulty=a),disabled:"","show-score":""},null,8,["modelValue"])])):i("",!0),Ba.value.techStack?(p(),l("div",va,[e[8]||(e[8]=t("span",{class:"label"},"技术栈：",-1)),t("div",ma,[(p(!0),l(u,null,r(Ba.value.techStack,a=>(p(),h(Qa,{key:a,size:"small",type:"success"},{default:n(()=>[d(c(a),1)]),_:2},1024))),128))])])):i("",!0),Ba.value.readTime?(p(),l("div",pa,[e[9]||(e[9]=t("span",{class:"label"},"预计阅读：",-1)),t("span",ha,c(Ba.value.readTime)+" 分钟",1)])):i("",!0)])]),Oa.value.length?(p(),l("div",fa,[e[11]||(e[11]=t("h3",null,"相关技术文章",-1)),t("div",ga,[(p(!0),l(u,null,r(Oa.value,s=>(p(),l("div",{key:s.id,class:"related-item",onClick:e=>a.$router.push(`/tech-share/${s.slug}`)},[t("img",{src:s.coverImage||"/default-tech.jpg",alt:s.title,onError:e[1]||(e[1]=(...e)=>a.onRelatedCoverError&&a.onRelatedCoverError(...e))},null,40,ya),t("div",_a,[t("h4",null,c(s.title),1),t("p",null,c(s.excerpt),1)])],8,ka))),128))])])):i("",!0)])])]),t("footer",Ca,[t("div",wa,[s(ae,{type:Ra.value?"primary":"default",icon:o(j),size:"large",onClick:Ja},{default:n(()=>[d(c(Ra.value?"已点赞":"点赞")+" ("+c(Ba.value.likeCount)+") ",1)]),_:1},8,["type","icon"]),s(ae,{icon:o(L),size:"large",onClick:Na},{default:n(()=>e[12]||(e[12]=[d(" 分享技术 ",-1)])),_:1,__:[12]},8,["icon"]),s(ae,{icon:o(x),size:"large",onClick:Wa},{default:n(()=>e[13]||(e[13]=[d(" 收藏 ",-1)])),_:1,__:[13]},8,["icon"])])]),t("section",ja,[t("h3",null,"技术讨论 ("+c(Ba.value.commentCount||0)+")",1),o(Ua).isLoggedIn?(p(),l("div",ba,[s(ee,{modelValue:Fa.value,"onUpdate:modelValue":e[2]||(e[2]=a=>Fa.value=a),type:"textarea",rows:4,placeholder:"参与技术讨论，分享你的见解...",maxlength:"500","show-word-limit":""},null,8,["modelValue"]),t("div",La,[s(ae,{type:"primary",loading:Ga.value,onClick:Xa},{default:n(()=>e[14]||(e[14]=[d(" 发表讨论 ",-1)])),_:1,__:[14]},8,["loading"])])])):(p(),l("div",xa,[t("p",null,[s(le,{to:"/auth/login"},{default:n(()=>e[15]||(e[15]=[d("登录",-1)])),_:1,__:[15]}),e[16]||(e[16]=d(" 后参与技术讨论 ",-1))])])),t("div",za,[(p(!0),l(u,null,r(Pa.value,a=>{var e,u;return p(),l("div",{key:a.id,class:"comment-item"},[t("div",Aa,[s(qa,{src:null==(e=a.user)?void 0:e.avatar,size:40},{default:n(()=>{var e,l;return[d(c(null==(l=null==(e=a.user)?void 0:e.nickname)?void 0:l.charAt(0)),1)]}),_:2},1032,["src"])]),t("div",Ia,[t("div",Ta,[t("span",Va,c(null==(u=a.user)?void 0:u.nickname),1),t("span",$a,c(Ka(a.createdAt)),1)]),t("div",Ha,c(a.content),1),t("div",Ma,[s(ae,{size:"small",text:"",type:a.isLiked?"primary":"default",icon:o(j),onClick:e=>(async a=>{if(Ua.isLoggedIn)try{a.isLiked?(await S.unlikeComment(a.id),a.likeCount--):(await S.likeComment(a.id),a.likeCount++),a.isLiked=!a.isLiked}catch(e){I.error("操作失败")}else I.warning("请先登录")})(a)},{default:n(()=>[d(c(a.isLiked?"已赞":"点赞")+" ",1),a.likeCount>0?(p(),l("span",Da,"("+c(a.likeCount)+")",1)):i("",!0)]),_:2},1032,["type","icon","onClick"])])])])}),128))])])])):(p(),l("div",Ea,[s(te,{icon:"warning",title:"技术文章不存在","sub-title":"抱歉，您访问的技术文章不存在或已被删除"},{extra:n(()=>[s(ae,{type:"primary",onClick:e[3]||(e[3]=e=>a.$router.push("/tech-share"))},{default:n(()=>e[17]||(e[17]=[d(" 返回技术分享 ",-1)])),_:1,__:[17]})]),_:1})]))])])}}},[["__scopeId","data-v-b12d880d"]]);export{Sa as default};
