/* empty css             *//* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                  */import{r as a,b as e,w as s,p as t,c as l,a as i,Q as n,I as c,J as o,K as r,D as u,O as d,P as v,a6 as p,ay as m,o as f,M as y,u as _,H as k,L as g}from"./vue-B9wWIsxR.js";import{j as h,m as j,J as C,r as w,a1 as b,E as x,aJ as z,bc as R,e as U,aA as P,aO as V,ay as A,aP as I,M as J,W as O,U as E}from"./element-plus-CXASJE3V.js";import{s as M,b as D}from"./positionedConfirm-DdmNknNt.js";import{d as H,c as K,m as L,e as N,b as Q}from"./notification-BWAPbIk2.js";import{_ as S}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./index-di9GIa25.js";import"./utils-C28rWPR3.js";const W={class:"notifications-view"},$={class:"page-header"},q={class:"header-content"},B={class:"header-actions"},F={class:"notifications-content"},G={class:"filter-section"},T={class:"filter-tabs"},X={class:"filter-actions"},Y={key:0,class:"notifications-list"},Z=["onClick"],aa={class:"notification-content"},ea={class:"notification-header"},sa={class:"notification-title"},ta={class:"notification-meta"},la={class:"notification-time"},ia={class:"notification-description"},na={class:"notification-actions"},ca={key:0,class:"notification-status"},oa={key:1,class:"empty-state"},ra={class:"empty-icon"},ua={key:2,class:"pagination-section"},da=S({__name:"NotificationsView",setup(S){const da=m(),va=a("all"),pa=a(""),ma=a(1),fa=a(10),ya=a(!1),_a=a([]),ka=a(0),ga=e(()=>_a.value.filter(a=>!a.isRead).length),ha=e(()=>_a.value),ja=e(()=>_a.value),Ca=a=>({comment:"评论",system:"系统",user:"用户",like:"点赞",success:"成功",warning:"警告",info:"信息"}[a]||"通知"),wa=async()=>{try{await L(),_a.value.forEach(a=>a.isRead=!0),x.success("所有通知已标记为已读")}catch(a){x.error("标记所有已读失败")}},ba=a=>{a.actionUrl&&da.push(a.actionUrl)},xa=a=>{ma.value=a},za=async()=>{try{ya.value=!0;const a={page:ma.value-1,size:fa.value};"all"!==va.value&&(a.type=va.value),pa.value&&(a.keyword=pa.value);const e=(await H(a)).data||{};_a.value=e.content||[],ka.value=e.total||0}catch(a){x.error("加载通知失败")}finally{ya.value=!1}};return s([va,pa],()=>{ma.value=1,za()}),s(ma,()=>{za()}),t(()=>{za()}),(a,e)=>{const s=w,t=h,m=j,H=U,L=b,S=C;return f(),l("div",W,[i("div",$,[i("div",q,[e[9]||(e[9]=i("div",{class:"title-section"},[i("h1",null,"通知中心"),i("p",null,"管理您的所有通知消息")],-1)),i("div",B,[n(t,{type:"primary",onClick:wa,disabled:0===ga.value},{default:c(()=>[n(s,null,{default:c(()=>[n(_(z))]),_:1}),e[7]||(e[7]=y(" 全部标记已读 ",-1))]),_:1,__:[7]},8,["disabled"]),n(t,{onClick:e[0]||(e[0]=a=>(async a=>{try{await M("确定要清空所有通知吗？此操作不可恢复。","确认清空",a),await K(),_a.value=[],x.success("所有通知已清空")}catch(e){"cancel"!==e&&x.error("清空通知失败")}})(a))},{default:c(()=>[n(s,null,{default:c(()=>[n(_(R))]),_:1}),e[8]||(e[8]=y(" 清空通知 ",-1))]),_:1,__:[8]})])])]),i("div",F,[i("div",G,[i("div",T,[i("div",{class:u(["tab-item",{active:"all"===va.value}]),onClick:e[1]||(e[1]=a=>va.value="all")}," 全部通知 ("+d(_a.value.length)+") ",3),i("div",{class:u(["tab-item",{active:"unread"===va.value}]),onClick:e[2]||(e[2]=a=>va.value="unread")}," 未读通知 ("+d(ga.value)+") ",3),i("div",{class:u(["tab-item",{active:"comment"===va.value}]),onClick:e[3]||(e[3]=a=>va.value="comment")}," 评论通知 ",2),i("div",{class:u(["tab-item",{active:"system"===va.value}]),onClick:e[4]||(e[4]=a=>va.value="system")}," 系统通知 ",2)]),i("div",X,[n(m,{modelValue:pa.value,"onUpdate:modelValue":e[5]||(e[5]=a=>pa.value=a),placeholder:"搜索通知...","prefix-icon":"Search",clearable:"",style:{width:"300px"}},null,8,["modelValue"])])]),ha.value.length>0?o((f(),l("div",Y,[(f(!0),l(v,null,p(ja.value,a=>{return f(),l("div",{class:u(["notification-card",{unread:!a.isRead}]),key:a.id,onClick:e=>ba(a)},[i("div",{class:u(["notification-avatar",a.type])},[n(s,null,{default:c(()=>{return[(f(),k(g((e=a.type,{comment:E,system:O,user:J,like:I,success:I,warning:A,info:V}[e]||P))))];var e}),_:2},1024)],2),i("div",aa,[i("div",ea,[i("h3",sa,d(a.title),1),i("div",ta,[i("span",la,d(a.timeAgo||a.createdAt),1),n(H,{type:(o=a.type,{comment:"primary",system:"info",user:"success",like:"success",success:"success",warning:"warning",info:"info"}[o]||"info"),size:"small"},{default:c(()=>[y(d(Ca(a.type)),1)]),_:2},1032,["type"])])]),i("p",ia,d(a.content),1),i("div",na,[a.isRead?r("",!0):(f(),k(t,{key:0,size:"small",type:"primary",text:"",onClick:e=>(async a=>{try{await Q(a.id),a.isRead=!0,x.success("已标记为已读")}catch(e){x.error("标记已读失败")}})(a)},{default:c(()=>e[10]||(e[10]=[y(" 标记已读 ",-1)])),_:2,__:[10]},1032,["onClick"])),n(t,{size:"small",text:"",onClick:e=>(async(a,e)=>{try{await D("这条通知",e),await N(a.id);const s=_a.value.findIndex(e=>e.id===a.id);s>-1&&(_a.value.splice(s,1),x.success("通知已删除"))}catch(s){"cancel"!==s&&x.error("删除通知失败")}})(a,e)},{default:c(()=>e[11]||(e[11]=[y(" 删除 ",-1)])),_:2,__:[11]},1032,["onClick"]),a.actionUrl?(f(),k(t,{key:1,size:"small",type:"primary",onClick:e=>ba(a)},{default:c(()=>e[12]||(e[12]=[y(" 查看详情 ",-1)])),_:2,__:[12]},1032,["onClick"])):r("",!0)])]),a.isRead?r("",!0):(f(),l("div",ca,e[13]||(e[13]=[i("div",{class:"unread-indicator"},null,-1)])))],10,Z);var o}),128))])),[[S,ya.value]]):(f(),l("div",oa,[i("div",ra,[n(s,null,{default:c(()=>[n(_(P))]),_:1})]),e[14]||(e[14]=i("h3",null,"暂无通知",-1)),i("p",null,d("unread"===va.value?"所有通知都已阅读":"all"!==va.value?`暂无${Ca(va.value)}通知`:pa.value?"没有找到匹配的通知":"暂时没有任何通知"),1)])),ka.value>fa.value?(f(),l("div",ua,[n(L,{"current-page":ma.value,"onUpdate:currentPage":e[6]||(e[6]=a=>ma.value=a),"page-size":fa.value,total:ka.value,layout:"prev, pager, next, jumper, total",onCurrentChange:xa},null,8,["current-page","page-size","total"])])):r("",!0)])])}}},[["__scopeId","data-v-53cd2e31"]]);export{da as default};
