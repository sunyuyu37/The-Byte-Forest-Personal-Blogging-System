import{_ as ss,u as es,av as B,r as g,a4 as F,c as os,b as i,d as e,ag as m,J as p,P as h,e as v,az as S,G as d,H as k,aA as I,R as ns,aB as as,w as N,f as ts,aj as rs,k as ls,l as u,L as y,aC as O}from"./index-Da7ZqcH5.js";import{F as x}from"./ForestIcons-B2SAK2JE.js";const is={class:"register-page"},us={class:"form-content"},ds={class:"input-section"},ms={class:"input-wrapper"},cs={class:"input-icon"},fs={key:0,class:"validation-icon"},ps={key:0,class:"success-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},vs={key:1,class:"error-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},ws={key:0,class:"error-message"},gs={key:1,class:"success-message"},ks={class:"input-wrapper"},ys={class:"input-icon"},xs={key:0,class:"validation-icon"},Ts={key:0,class:"success-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},hs={key:1,class:"error-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},bs={key:0,class:"error-message"},Ps={key:1,class:"success-message"},Fs={class:"input-wrapper"},Cs={class:"input-icon"},zs={key:0,class:"validation-icon"},_s={key:0,class:"success-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},Bs={key:1,class:"error-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},$s={key:0,class:"error-message"},Us={key:1,class:"success-message"},Ls={class:"input-wrapper"},Ms={class:"input-icon"},Rs=["type"],Ss={key:0,class:"error-message"},Ns={key:1,class:"password-strength"},Vs={class:"strength-bar"},Ds={class:"input-wrapper"},As={class:"input-icon"},Es=["type"],js={key:0,class:"error-message"},Zs={key:1,class:"success-message"},Is={class:"terms-agreement"},Os={class:"agreement-checkbox"},Gs={class:"agreement-text"},Hs={key:0,class:"error-message"},Js=["disabled"],Xs={key:0,class:"button-text forest-text"},Ys={key:1,class:"button-loading"},qs={class:"login-link"},Ks={__name:"Register",setup(Qs){const G=ls(),V=es(),t=B({username:"",nickname:"",email:"",password:"",confirmPassword:"",agreeToTerms:!1}),o=B({username:"",nickname:"",email:"",password:"",confirmPassword:"",agreeToTerms:""}),n=B({username:!1,nickname:!1,email:!1,password:!1,confirmPassword:!1}),b=g(!1),C=g(!1),z=g(!1),$=g(!1),U=g(!1),L=g(!1),M=g(!1),R=g(!1),D=g(null),w=B({username:null,email:null,nickname:null}),H=a=>{w.nickname&&clearTimeout(w.nickname),w.nickname=setTimeout(()=>{a&&a.trim().length>=2&&(n.nickname=!0,o.nickname="")},400)};F(()=>t.nickname,a=>{n.nickname=!1,o.nickname="",a&&H(a)});const A=()=>{var s;const a=((s=t.nickname)==null?void 0:s.trim())||"";if(!a){o.nickname="请输入昵称",n.nickname=!1;return}if(a.length<2){o.nickname="昵称至少2个字符",n.nickname=!1;return}if(a.length>20){o.nickname="昵称最多20个字符",n.nickname=!1;return}if(!/^[\u4e00-\u9fa5\w-]+$/.test(a)){o.nickname="昵称只能包含中文、字母、数字、下划线或连字符",n.nickname=!1;return}o.nickname="",n.nickname=!0},P=os(()=>{const a=t.password;if(!a)return{width:"0%",class:"",text:""};let s=0,l="",r="";return a.length>=8?s+=2:a.length>=6&&(s+=1),/[a-z]/.test(a)&&(s+=1),/[A-Z]/.test(a)&&(s+=1),/[0-9]/.test(a)&&(s+=1),/[^A-Za-z0-9]/.test(a)&&(s+=1),s<=2?(l="弱",r="weak",{width:"33%",class:r,text:l}):s<=4?(l="中等",r="medium",{width:"66%",class:r,text:l}):(l="强",r="strong",{width:"100%",class:r,text:l})}),J=a=>{w.username&&clearTimeout(w.username),w.username=setTimeout(async()=>{if(a&&a.length>=3)try{(await O.checkUsername(a)).data?(n.username=!0,o.username=""):(n.username=!1,o.username="用户名已被使用")}catch{n.username=!1,o.username="检查用户名失败"}},500)},X=a=>{w.email&&clearTimeout(w.email),w.email=setTimeout(async()=>{if(a&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a))try{(await O.checkEmail(a)).data?(n.email=!0,o.email=""):(n.email=!1,o.email="邮箱已被注册")}catch{n.email=!1,o.email="检查邮箱失败"}},500)};F(()=>t.username,a=>{n.username=!1,o.username="",a&&J(a)}),F(()=>t.email,a=>{n.email=!1,o.email="",a&&X(a)}),F(()=>t.password,()=>{n.password=!1,o.password="",t.confirmPassword&&_()}),F(()=>t.confirmPassword,()=>{_()});const E=()=>{t.username.trim()?t.username.length<3?(o.username="用户名至少3个字符",n.username=!1):t.username.length>20?(o.username="用户名最多20个字符",n.username=!1):/^[a-zA-Z0-9_\u4e00-\u9fa5]+$/.test(t.username)||(o.username="用户名只能包含字母、数字、下划线和中文",n.username=!1):(o.username="请输入用户名",n.username=!1)},j=()=>{const a=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;t.email.trim()?a.test(t.email)||(o.email="邮箱格式不正确",n.email=!1):(o.email="请输入邮箱地址",n.email=!1)},Z=()=>{t.password?t.password.length<6?(o.password="密码至少6个字符",n.password=!1):t.password.length>50?(o.password="密码最多50个字符",n.password=!1):(o.password="",n.password=P.value.class!=="weak"):(o.password="请输入密码",n.password=!1)},_=()=>{t.confirmPassword?t.password!==t.confirmPassword?(o.confirmPassword="两次输入的密码不一致",n.confirmPassword=!1):(o.confirmPassword="",n.confirmPassword=!0):(o.confirmPassword="请确认密码",n.confirmPassword=!1)},Y=()=>(E(),A(),j(),Z(),_(),t.agreeToTerms?o.agreeToTerms="":o.agreeToTerms="请同意服务条款和隐私政策",!Object.values(o).some(a=>a)&&Object.values(n).every(a=>a)&&t.agreeToTerms),q=async()=>{var a,s,l,r,T;if(!Y()){y.warning("请填写完整且正确的信息");return}b.value=!0;try{let c;try{c=await V.register({username:t.username,nickname:t.nickname,email:t.email,password:t.password})}catch(f){const Q=((s=(a=f==null?void 0:f.response)==null?void 0:a.data)==null?void 0:s.message)||(f==null?void 0:f.message)||"",W=/Unrecognized field|Unknown property|无法识别的字段|未知属性/.test(String(Q));if(((l=f==null?void 0:f.response)==null?void 0:l.status)===400&&W)c=await V.register({username:t.username,email:t.email,password:t.password}),y.info("后端暂未支持注册时设置昵称，已先完成注册，您可在个人中心修改昵称");else throw f}c.code===200?(y.success("注册成功！欢迎加入字节森林"),G.push("/auth/login")):y.error(c.message||"注册失败")}catch(c){console.error("注册错误:",c),(T=(r=c.response)==null?void 0:r.data)!=null&&T.message?y.error(c.response.data.message):c.message?y.error(c.message):y.error("注册失败，请检查网络连接")}finally{b.value=!1}},K=a=>{const s=a.currentTarget,l=D.value,r=s.getBoundingClientRect(),T=Math.max(r.width,r.height),c=a.clientX-r.left-T/2,f=a.clientY-r.top-T/2;l&&(l.style.width=l.style.height=T+"px",l.style.left=c+"px",l.style.top=f+"px",l.classList.add("active"),setTimeout(()=>{l.classList.remove("active")},600))};return(a,s)=>{const l=ts("router-link");return u(),i("div",is,[e("form",{onSubmit:rs(q,["prevent"]),class:"register-form"},[e("div",us,[e("div",ds,[e("div",{class:m(["input-group",{focused:$.value,error:o.username,success:n.username}])},[e("div",ms,[e("div",cs,[v(x,{name:"leaf",color:"currentColor",size:20})]),h(e("input",{"onUpdate:modelValue":s[0]||(s[0]=r=>t.username=r),type:"text",placeholder:"用户名",onFocus:s[1]||(s[1]=r=>$.value=!0),onBlur:s[2]||(s[2]=r=>{$.value=!1,E()}),class:m({error:o.username,success:n.username})},null,34),[[S,t.username]]),n.username||o.username?(u(),i("div",fs,[n.username?(u(),i("svg",ps,s[18]||(s[18]=[e("path",{d:"M9 16.17l-3.59-3.58L4 14l5 5 12-12-1.41-1.42L9 16.17z",fill:"#78FFD6"},null,-1)]))):(u(),i("svg",vs,s[19]||(s[19]=[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z",fill:"#FF8C42"},null,-1)])))])):p("",!0),s[20]||(s[20]=e("div",{class:"focus-line"},null,-1))]),o.username?(u(),i("div",ws,[s[21]||(s[21]=e("div",{class:"error-icon"},"⚠",-1)),d(" "+k(o.username),1)])):n.username?(u(),i("div",gs,s[22]||(s[22]=[e("div",{class:"success-icon"},"✓",-1),d(" 用户名可用 ",-1)]))):p("",!0)],2),e("div",{class:m(["input-group",{focused:U.value,error:o.nickname,success:n.nickname}])},[e("div",ks,[e("div",ys,[v(x,{name:"sapling",color:"currentColor",size:20})]),h(e("input",{"onUpdate:modelValue":s[3]||(s[3]=r=>t.nickname=r),type:"text",placeholder:"昵称",onFocus:s[4]||(s[4]=r=>U.value=!0),onBlur:s[5]||(s[5]=r=>{U.value=!1,A()}),class:m({error:o.nickname,success:n.nickname})},null,34),[[S,t.nickname]]),n.nickname||o.nickname?(u(),i("div",xs,[n.nickname?(u(),i("svg",Ts,s[23]||(s[23]=[e("path",{d:"M9 16.17l-3.59-3.58L4 14l5 5 12-12-1.41-1.42L9 16.17z",fill:"#78FFD6"},null,-1)]))):(u(),i("svg",hs,s[24]||(s[24]=[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z",fill:"#FF8C42"},null,-1)])))])):p("",!0),s[25]||(s[25]=e("div",{class:"focus-line"},null,-1))]),o.nickname?(u(),i("div",bs,[s[26]||(s[26]=e("div",{class:"error-icon"},"⚠",-1)),d(" "+k(o.nickname),1)])):n.nickname?(u(),i("div",Ps,s[27]||(s[27]=[e("div",{class:"success-icon"},"✓",-1),d(" 昵称可用 ",-1)]))):p("",!0)],2),e("div",{class:m(["input-group",{focused:L.value,error:o.email,success:n.email}])},[e("div",Fs,[e("div",Cs,[v(x,{name:"leaf",color:"currentColor",size:20})]),h(e("input",{"onUpdate:modelValue":s[6]||(s[6]=r=>t.email=r),type:"email",placeholder:"邮箱地址",onFocus:s[7]||(s[7]=r=>L.value=!0),onBlur:s[8]||(s[8]=r=>{L.value=!1,j()}),class:m({error:o.email,success:n.email})},null,34),[[S,t.email]]),n.email||o.email?(u(),i("div",zs,[n.email?(u(),i("svg",_s,s[28]||(s[28]=[e("path",{d:"M9 16.17l-3.59-3.58L4 14l5 5 12-12-1.41-1.42L9 16.17z",fill:"#78FFD6"},null,-1)]))):(u(),i("svg",Bs,s[29]||(s[29]=[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z",fill:"#FF8C42"},null,-1)])))])):p("",!0),s[30]||(s[30]=e("div",{class:"focus-line"},null,-1))]),o.email?(u(),i("div",$s,[s[31]||(s[31]=e("div",{class:"error-icon"},"⚠",-1)),d(" "+k(o.email),1)])):n.email?(u(),i("div",Us,s[32]||(s[32]=[e("div",{class:"success-icon"},"✓",-1),d(" 邮箱格式正确 ",-1)]))):p("",!0)],2),e("div",{class:m(["input-group",{focused:M.value,error:o.password,success:n.password}])},[e("div",Ls,[e("div",Ms,[v(x,{name:"tree-lock",color:"currentColor",size:20})]),h(e("input",{"onUpdate:modelValue":s[9]||(s[9]=r=>t.password=r),type:C.value?"text":"password",placeholder:"密码",onFocus:s[10]||(s[10]=r=>M.value=!0),onBlur:s[11]||(s[11]=r=>{M.value=!1,Z()}),class:m({error:o.password,success:n.password})},null,42,Rs),[[I,t.password]]),e("button",{type:"button",class:"password-toggle",onClick:s[12]||(s[12]=r=>C.value=!C.value)},[v(x,{name:C.value?"forest":"leaf",color:"currentColor",size:20},null,8,["name"])]),s[33]||(s[33]=e("div",{class:"focus-line"},null,-1))]),o.password?(u(),i("div",Ss,[s[34]||(s[34]=e("div",{class:"error-icon"},"⚠",-1)),d(" "+k(o.password),1)])):p("",!0),t.password?(u(),i("div",Ns,[s[35]||(s[35]=e("div",{class:"strength-label"},"密码强度：",-1)),e("div",Vs,[e("div",{class:m(["strength-fill",P.value.class]),style:ns({width:P.value.width})},null,6)]),e("div",{class:m(["strength-text",P.value.class])},k(P.value.text),3)])):p("",!0)],2),e("div",{class:m(["input-group",{focused:R.value,error:o.confirmPassword,success:n.confirmPassword}])},[e("div",Ds,[e("div",As,[v(x,{name:"tree-lock",color:"currentColor",size:20})]),h(e("input",{"onUpdate:modelValue":s[13]||(s[13]=r=>t.confirmPassword=r),type:z.value?"text":"password",placeholder:"确认密码",onFocus:s[14]||(s[14]=r=>R.value=!0),onBlur:s[15]||(s[15]=r=>{R.value=!1,_()}),class:m({error:o.confirmPassword,success:n.confirmPassword})},null,42,Es),[[I,t.confirmPassword]]),e("button",{type:"button",class:"password-toggle",onClick:s[16]||(s[16]=r=>z.value=!z.value)},[v(x,{name:z.value?"forest":"leaf",color:"currentColor",size:20},null,8,["name"])]),s[36]||(s[36]=e("div",{class:"focus-line"},null,-1))]),o.confirmPassword?(u(),i("div",js,[s[37]||(s[37]=e("div",{class:"error-icon"},"⚠",-1)),d(" "+k(o.confirmPassword),1)])):n.confirmPassword?(u(),i("div",Zs,s[38]||(s[38]=[e("div",{class:"success-icon"},"✓",-1),d(" 密码确认一致 ",-1)]))):p("",!0)],2)]),e("div",Is,[e("label",Os,[h(e("input",{type:"checkbox","onUpdate:modelValue":s[17]||(s[17]=r=>t.agreeToTerms=r)},null,512),[[as,t.agreeToTerms]]),s[43]||(s[43]=e("span",{class:"custom-checkbox"},null,-1)),e("span",Gs,[s[41]||(s[41]=d(" 我已阅读并同意 ",-1)),v(l,{to:"/terms",class:"terms-link"},{default:N(()=>s[39]||(s[39]=[d("《服务条款》",-1)])),_:1,__:[39]}),s[42]||(s[42]=d(" 和 ",-1)),v(l,{to:"/privacy",class:"privacy-link"},{default:N(()=>s[40]||(s[40]=[d("《隐私政策》",-1)])),_:1,__:[40]})])]),o.agreeToTerms?(u(),i("div",Hs,[s[44]||(s[44]=e("div",{class:"error-icon"},"⚠",-1)),d(" "+k(o.agreeToTerms),1)])):p("",!0)]),e("button",{type:"submit",class:m(["register-button",{loading:b.value}]),disabled:b.value||!t.agreeToTerms,onClick:K},[b.value?(u(),i("div",Ys,s[45]||(s[45]=[e("div",{class:"vine-loader"},null,-1),e("span",null,"种植中...",-1)]))):(u(),i("span",Xs,"踏入字节森林")),e("div",{class:"button-ripple",ref_key:"rippleRef",ref:D},null,512)],10,Js),e("div",qs,[s[47]||(s[47]=e("span",null,"已经有账户了？",-1)),v(l,{to:"/auth/login",class:"login-vine"},{default:N(()=>s[46]||(s[46]=[d(" 返回森林 ",-1),e("div",{class:"vine-growth"},null,-1)])),_:1,__:[46]})])])],32)])}}},ee=ss(Ks,[["__scopeId","data-v-19ea235d"]]);export{ee as default};
