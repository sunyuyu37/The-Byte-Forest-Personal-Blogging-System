import{_ as G,r as _,c as H,a4 as J,o as L,b as n,d as l,e as r,w as u,a9 as M,J as z,X as Q,H as v,G as g,n as X,N as C,O as E,a as q,l as s,I as A,ae as K,h as W,B as Y,a8 as Z,Q as $}from"./index-Da7ZqcH5.js";/* empty css                   *//* empty css               */import"./scrollbar-PN-ehNXN.js";/* empty css              */import{A as ee}from"./ArticleCard-BnxaohSY.js";import{g as te}from"./tag-BSfDvdma.js";import{E as ae,a as se}from"./index-mDFjMy5P.js";import{E as le}from"./index-DuvIoQvO.js";import{E as oe}from"./index-DSEo_ZHY.js";import"./vnode-DsZHVpXe.js";import"./placeholder-BiywPu__.js";import"./castArray-DVWVVBpp.js";import"./isEqual-HUGtL056.js";import"./_Uint8Array-CNK7Frb1.js";const ne={class:"tag-page"},re={class:"container"},ie={class:"page-header"},ue={class:"breadcrumb"},ce={key:0,class:"tag-info"},de={class:"title"},pe={key:0,class:"description"},_e={class:"stats"},ve={class:"stat-item"},me={key:1,class:"all-tags"},ge={key:0,class:"tags-section"},fe={class:"tags-cloud"},ye={class:"popular-tags"},he={class:"popular-tags-list"},ke=["onClick"],Ce={class:"tag-name"},Ee={class:"tag-stats"},be={key:1,class:"articles-section"},we={class:"filters"},Te={class:"filter-group"},Be={key:0,class:"loading"},ze={key:1,class:"articles-list"},Ae={key:2,class:"empty-state"},Ve={key:3,class:"pagination"},$e={__name:"Tag",setup(Ne){const N=q(),b=_(!1),m=_([]),o=_(null),c=_([]),f=_(1),h=_(12),d=_(0),k=_("latest"),P=H(()=>[...m.value].sort((t,e)=>e.articleCount-t.articleCount).slice(0,8)),w=t=>t>=20?"danger":t>=10?"warning":t>=5?"success":"info",S=t=>t>=20?"large":t>=10?"default":"small",V=async()=>{try{const t=await te();t.code===200&&Array.isArray(t.data)?m.value=t.data:m.value=[]}catch(t){console.error("加载标签失败:",t),m.value=[]}},x=async t=>{try{m.value.length||await V();const e=m.value.find(i=>i.slug===t);o.value=e||null}catch(e){console.error("加载标签信息失败:",e),o.value=null}},T=async()=>{var t;if(o.value){b.value=!0;try{const e={page:f.value-1,size:h.value},i=await $.getArticlesByTag(o.value.slug,e);i.code===200&&i.data?(c.value=i.data.content||[],d.value=i.data.totalElements||0):(c.value=[],d.value=0)}catch(e){if(console.error("加载文章失败:",e),((t=e==null?void 0:e.response)==null?void 0:t.status)===404)try{const y={keyword:"",tag:o.value.slug,page:f.value-1,size:h.value,sortBy:k.value==="popular"?"views":k.value==="liked"?"likes":"latest"},p=await $.searchArticles(y);p.code===200&&p.data?(c.value=p.data.content||[],d.value=p.data.totalElements||0):(c.value=[],d.value=0)}catch(y){console.error("搜索兜底失败:",y),c.value=[],d.value=0}else c.value=[],d.value=0}finally{b.value=!1}}},I=t=>{f.value=t,T()};return J(()=>N.params.slug,async t=>{f.value=1,await x(t),o.value?await T():await V()},{immediate:!0}),L(()=>{}),(t,e)=>{const i=K,y=M,p=Q,O=X,B=se,R=ae,U=Z,j=le,D=oe;return s(),n("div",ne,[l("div",re,[l("div",ie,[l("div",ue,[r(y,{separator:"/"},{default:u(()=>[r(i,{to:"/"},{default:u(()=>e[2]||(e[2]=[g("首页",-1)])),_:1,__:[2]}),r(i,null,{default:u(()=>e[3]||(e[3]=[g("标签",-1)])),_:1,__:[3]}),o.value?(s(),A(i,{key:0},{default:u(()=>[g(v(o.value.name),1)]),_:1})):z("",!0)]),_:1})]),o.value?(s(),n("div",ce,[l("h1",de,[r(p,{type:w(o.value.articleCount),size:"large"},{default:u(()=>[g(v(o.value.name),1)]),_:1},8,["type"])]),o.value.description?(s(),n("p",pe,v(o.value.description),1)):z("",!0),l("div",_e,[l("span",ve,[r(O,null,{default:u(()=>[r(W(Y))]),_:1}),g(" "+v(o.value.articleCount)+" 篇文章 ",1)])])])):(s(),n("div",me,e[4]||(e[4]=[l("h1",{class:"title"},"文章标签",-1),l("p",{class:"description"},"浏览所有文章标签",-1)])))]),o.value?(s(),n("div",be,[l("div",we,[l("div",Te,[e[6]||(e[6]=l("label",null,"排序方式：",-1)),r(R,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=a=>k.value=a),onChange:T},{default:u(()=>[r(B,{label:"最新发布",value:"latest"}),r(B,{label:"最多阅读",value:"popular"}),r(B,{label:"最多点赞",value:"liked"})]),_:1},8,["modelValue"])])]),b.value?(s(),n("div",Be,[(s(),n(C,null,E(6,a=>r(U,{key:a,rows:3,animated:""})),64))])):c.value.length?(s(),n("div",ze,[(s(!0),n(C,null,E(c.value,a=>(s(),A(ee,{key:a.id,article:a},null,8,["article"]))),128))])):(s(),n("div",Ae,[r(j,{description:"该标签下暂无文章"})])),d.value>h.value?(s(),n("div",Ve,[r(D,{"current-page":f.value,"onUpdate:currentPage":e[1]||(e[1]=a=>f.value=a),"page-size":h.value,total:d.value,layout:"prev, pager, next, jumper",onCurrentChange:I},null,8,["current-page","page-size","total"])])):z("",!0)])):(s(),n("div",ge,[l("div",fe,[(s(!0),n(C,null,E(m.value,a=>(s(),A(p,{key:a.id,type:w(a.articleCount),size:S(a.articleCount),class:"tag-item",onClick:F=>t.$router.push(`/tag/${a.slug}`)},{default:u(()=>[g(v(a.name)+" ("+v(a.articleCount)+") ",1)]),_:2},1032,["type","size","onClick"]))),128))]),l("div",ye,[e[5]||(e[5]=l("h3",null,"热门标签",-1)),l("div",he,[(s(!0),n(C,null,E(P.value,a=>(s(),n("div",{key:a.id,class:"popular-tag-card",onClick:F=>t.$router.push(`/tag/${a.slug}`)},[l("div",Ce,[r(p,{type:w(a.articleCount)},{default:u(()=>[g(v(a.name),1)]),_:2},1032,["type"])]),l("div",Ee,v(a.articleCount)+" 篇文章 ",1)],8,ke))),128))])])]))])])}}},Qe=G($e,[["__scopeId","data-v-482c239d"]]);export{Qe as default};
