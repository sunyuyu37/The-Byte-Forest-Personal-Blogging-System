/* empty css             *//* empty css                  *//* empty css                 *//* empty css                  *//* empty css                  *//* empty css               *//* empty css                           *//* empty css                         */import{r as e,p as a,c as l,a as t,Q as s,K as i,I as c,O as n,P as u,a6 as o,H as r,u as d,M as v,al as m,aD as p,o as k}from"./vue-B9wWIsxR.js";import{u as f}from"./index-di9GIa25.js";import{a6 as g,a7 as y,e as _,G as h,aa as j,r as C,ae as w,v as b,F as x,j as L,a8 as z,af as I,m as A,a9 as T,E as H,ab as E,ag as M,a5 as P,U as V,ah as $,ai as D}from"./element-plus-CXASJE3V.js";import{a as R}from"./article-Pn5uYJFo.js";import{c as Y}from"./comment-DttPZ_iH.js";import{_ as S}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./utils-C28rWPR3.js";const U={class:"project-practice-detail"},F={class:"container"},G={key:0,class:"loading"},O={key:1,class:"article-content"},B={class:"project-header"},K={class:"breadcrumb"},N={class:"project-category"},Q={class:"title"},q={class:"project-meta"},J={class:"author-info"},W={class:"author-details"},X={class:"name"},Z={class:"time"},ee={class:"project-stats"},ae={class:"stat-item"},le={class:"stat-item"},te={class:"stat-item"},se={class:"stat-item"},ie={key:0,class:"project-tags"},ce={class:"project-body"},ne={class:"content-wrapper"},ue={class:"article-content"},oe=["innerHTML"],re={class:"project-sidebar"},de={class:"project-info-card"},ve={class:"project-details"},me={key:0,class:"project-type"},pe={key:1,class:"tech-stack"},ke={class:"tech-tags"},fe={key:2,class:"project-status"},ge={key:3,class:"read-time"},ye={class:"value"},_e={key:0,class:"project-links"},he={class:"links"},je={key:1,class:"related-projects"},Ce={class:"related-list"},we=["onClick"],be=["src","alt"],xe={class:"related-content"},Le={class:"project-footer"},ze={class:"actions"},Ie={class:"project-comments-section"},Ae={key:0,class:"comment-form"},Te={class:"form-actions"},He={key:1,class:"login-prompt"},Ee={class:"comments-list"},Me={class:"comment-avatar"},Pe={class:"comment-content"},Ve={class:"comment-header"},$e={class:"username"},De={class:"time"},Re={class:"comment-text"},Ye={class:"comment-actions"},Se={key:0},Ue={key:2,class:"not-found"},Fe=S({__name:"ProjectPracticeDetail",setup(S){const Fe=p(),Ge=f(),Oe=e(!0),Be=e(null),Ke=e([]),Ne=e([]),Qe=e(!1),qe=e(""),Je=e(!1),We=e=>j(e).format("YYYY-MM-DD HH:mm"),Xe=async()=>{var e;if(Be.value)try{const a=Be.value.slug||Be.value.id,l=await Y.getArticleComments(a),t=(null==(e=l.data)?void 0:e.content)||l.data||[];Ke.value=t.map(e=>({...e,isLiked:!1,likeCount:e.likeCount||0}))}catch(a){}},Ze=async()=>{try{Ne.value=[{id:1,slug:"vue-admin-system",title:"Vue3 后台管理系统",excerpt:"基于 Vue3 + Element Plus 的后台管理系统",coverImage:"/images/vue-admin.jpg"},{id:2,slug:"react-blog-platform",title:"React 博客平台",excerpt:"使用 React 和 Node.js 构建的博客系统",coverImage:"/images/react-blog.jpg"}]}catch(e){}},ea=async()=>{if(Ge.isLoggedIn)try{Qe.value?(await R.unlikeArticle(Be.value.id),Be.value.likeCount--):(await R.likeArticle(Be.value.id),Be.value.likeCount++),Qe.value=!Qe.value}catch(e){H.error("操作失败")}else H.warning("请先登录")},aa=()=>{navigator.share?navigator.share({title:Be.value.title,text:Be.value.excerpt,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),H.success("链接已复制到剪贴板"))},la=()=>{H.info("下载功能开发中...")},ta=async()=>{if(qe.value.trim()){Je.value=!0;try{await Y.createComment({articleId:Be.value.id,content:qe.value}),qe.value="",H.success("评论发表成功"),await Xe()}catch(e){H.error("评论失败")}finally{Je.value=!1}}else H.warning("请输入评论内容")};return a(async()=>{var e;Oe.value=!0;try{const l=Fe.params.slug,t=await R.getArticleBySlug(l);if(Be.value=t.data,Ge.isLoggedIn&&(null==(e=Be.value)?void 0:e.id))try{const e=await R.isArticleLiked(Be.value.id);Qe.value=!!e.data}catch(a){Qe.value=!1}await Xe(),await Ze()}catch(l){Be.value=null,H.error("加载文章失败，请稍后重试")}finally{Oe.value=!1}}),(e,a)=>{var p,f;const j=g,R=E,S=y,Fe=C,Xe=_,Ze=h,sa=L,ia=A,ca=m("router-link"),na=T;return k(),l("div",U,[t("div",F,[Oe.value?(k(),l("div",G,[s(j,{rows:12,animated:""})])):Be.value?(k(),l("div",O,[t("header",B,[t("div",K,[s(S,{separator:"/"},{default:c(()=>[s(R,{to:"/"},{default:c(()=>a[5]||(a[5]=[v("首页",-1)])),_:1,__:[5]}),s(R,{to:"/project-practice"},{default:c(()=>a[6]||(a[6]=[v("项目实践",-1)])),_:1,__:[6]}),s(R,null,{default:c(()=>[v(n(Be.value.title),1)]),_:1})]),_:1})]),t("div",N,[s(Xe,{type:"success",size:"large",effect:"dark"},{default:c(()=>[s(Fe,null,{default:c(()=>[s(d(M))]),_:1}),a[7]||(a[7]=v(" 项目实践 ",-1))]),_:1,__:[7]})]),t("h1",Q,n(Be.value.title),1),t("div",q,[t("div",J,[s(Ze,{src:null==(p=Be.value.author)?void 0:p.avatar,size:48},{default:c(()=>{var e,a;return[v(n(null==(a=null==(e=Be.value.author)?void 0:e.nickname)?void 0:a.charAt(0)),1)]}),_:1},8,["src"]),t("div",W,[t("div",X,n(null==(f=Be.value.author)?void 0:f.nickname),1),t("div",Z,n(We(Be.value.publishedAt)),1)])]),t("div",ee,[t("div",ae,[s(Fe,null,{default:c(()=>[s(d(P))]),_:1}),t("span",null,n(Be.value.viewCount)+" 阅读",1)]),t("div",le,[s(Fe,null,{default:c(()=>[s(d(x))]),_:1}),t("span",null,n(Be.value.likeCount)+" 点赞",1)]),t("div",te,[s(Fe,null,{default:c(()=>[s(d(V))]),_:1}),t("span",null,n(Be.value.commentCount||0)+" 评论",1)]),t("div",se,[s(Fe,null,{default:c(()=>[s(d($))]),_:1}),t("span",null,n(Be.value.forkCount||0)+" Fork",1)])])]),Be.value.tags&&Be.value.tags.length?(k(),l("div",ie,[(k(!0),l(u,null,o(Be.value.tags,a=>(k(),r(Xe,{key:a.id,type:"success",effect:"plain",size:"large",onClick:l=>e.$router.push(`/tag/${a.slug}`)},{default:c(()=>[s(Fe,null,{default:c(()=>[s(d(D))]),_:1}),v(" "+n(a.name),1)]),_:2},1032,["onClick"]))),128))])):i("",!0)]),t("main",ce,[t("div",ne,[t("div",ue,[t("div",{class:"content",innerHTML:Be.value.content},null,8,oe)]),t("aside",re,[t("div",de,[a[12]||(a[12]=t("h3",null,"项目信息",-1)),t("div",ve,[Be.value.projectType?(k(),l("div",me,[a[8]||(a[8]=t("span",{class:"label"},"项目类型：",-1)),s(Xe,{type:"success",size:"small"},{default:c(()=>[v(n(Be.value.projectType),1)]),_:1})])):i("",!0),Be.value.techStack?(k(),l("div",pe,[a[9]||(a[9]=t("span",{class:"label"},"技术栈：",-1)),t("div",ke,[(k(!0),l(u,null,o(Be.value.techStack,e=>(k(),r(Xe,{key:e,size:"small",type:"info"},{default:c(()=>[v(n(e),1)]),_:2},1024))),128))])])):i("",!0),Be.value.status?(k(),l("div",fe,[a[10]||(a[10]=t("span",{class:"label"},"项目状态：",-1)),s(Xe,{type:"进行中"===Be.value.status?"warning":"success",size:"small"},{default:c(()=>[v(n(Be.value.status),1)]),_:1},8,["type"])])):i("",!0),Be.value.readTime?(k(),l("div",ge,[a[11]||(a[11]=t("span",{class:"label"},"阅读时长：",-1)),t("span",ye,n(Be.value.readTime)+" 分钟",1)])):i("",!0)])]),Be.value.github||Be.value.demo?(k(),l("div",_e,[a[15]||(a[15]=t("h3",null,"项目链接",-1)),t("div",he,[Be.value.github?(k(),r(sa,{key:0,type:"success",icon:d(w),onClick:a[0]||(a[0]=a=>e.window.open(Be.value.github))},{default:c(()=>a[13]||(a[13]=[v(" GitHub 仓库 ",-1)])),_:1,__:[13]},8,["icon"])):i("",!0),Be.value.demo?(k(),r(sa,{key:1,type:"primary",icon:d(b),onClick:a[1]||(a[1]=a=>e.window.open(Be.value.demo))},{default:c(()=>a[14]||(a[14]=[v(" 在线演示 ",-1)])),_:1,__:[14]},8,["icon"])):i("",!0)])])):i("",!0),Ne.value.length?(k(),l("div",je,[a[16]||(a[16]=t("h3",null,"相关项目",-1)),t("div",Ce,[(k(!0),l(u,null,o(Ne.value,s=>(k(),l("div",{key:s.id,class:"related-item",onClick:a=>e.$router.push(`/project-practice/${s.slug}`)},[t("img",{src:s.coverImage||"/default-project.jpg",alt:s.title,onError:a[2]||(a[2]=(...a)=>e.onRelatedCoverError&&e.onRelatedCoverError(...a))},null,40,be),t("div",xe,[t("h4",null,n(s.title),1),t("p",null,n(s.excerpt),1)])],8,we))),128))])])):i("",!0)])])]),t("footer",Le,[t("div",ze,[s(sa,{type:Qe.value?"success":"default",icon:d(x),size:"large",onClick:ea},{default:c(()=>[v(n(Qe.value?"已点赞":"点赞")+" ("+n(Be.value.likeCount)+") ",1)]),_:1},8,["type","icon"]),s(sa,{icon:d(z),size:"large",onClick:aa},{default:c(()=>a[17]||(a[17]=[v(" 分享项目 ",-1)])),_:1,__:[17]},8,["icon"]),s(sa,{icon:d(I),size:"large",onClick:la},{default:c(()=>a[18]||(a[18]=[v(" 下载资源 ",-1)])),_:1,__:[18]},8,["icon"])])]),t("section",Ie,[t("h3",null,"项目讨论 ("+n(Be.value.commentCount||0)+")",1),d(Ge).isLoggedIn?(k(),l("div",Ae,[s(ia,{modelValue:qe.value,"onUpdate:modelValue":a[3]||(a[3]=e=>qe.value=e),type:"textarea",rows:4,placeholder:"分享你对这个项目的看法和建议...",maxlength:"500","show-word-limit":""},null,8,["modelValue"]),t("div",Te,[s(sa,{type:"success",loading:Je.value,onClick:ta},{default:c(()=>a[19]||(a[19]=[v(" 发表讨论 ",-1)])),_:1,__:[19]},8,["loading"])])])):(k(),l("div",He,[t("p",null,[s(ca,{to:"/auth/login"},{default:c(()=>a[20]||(a[20]=[v("登录",-1)])),_:1,__:[20]}),a[21]||(a[21]=v(" 后参与项目讨论 ",-1))])])),t("div",Ee,[(k(!0),l(u,null,o(Ke.value,e=>{var a,u;return k(),l("div",{key:e.id,class:"comment-item"},[t("div",Me,[s(Ze,{src:null==(a=e.user)?void 0:a.avatar,size:40},{default:c(()=>{var a,l;return[v(n(null==(l=null==(a=e.user)?void 0:a.nickname)?void 0:l.charAt(0)),1)]}),_:2},1032,["src"])]),t("div",Pe,[t("div",Ve,[t("span",$e,n(null==(u=e.user)?void 0:u.nickname),1),t("span",De,n(We(e.createdAt)),1)]),t("div",Re,n(e.content),1),t("div",Ye,[s(sa,{size:"small",text:"",type:e.isLiked?"success":"default",icon:d(x),onClick:a=>(async e=>{if(Ge.isLoggedIn)try{e.isLiked?(await Y.unlikeComment(e.id),e.likeCount--):(await Y.likeComment(e.id),e.likeCount++),e.isLiked=!e.isLiked}catch(a){H.error("操作失败")}else H.warning("请先登录")})(e)},{default:c(()=>[v(n(e.isLiked?"已赞":"点赞")+" ",1),e.likeCount>0?(k(),l("span",Se,"("+n(e.likeCount)+")",1)):i("",!0)]),_:2},1032,["type","icon","onClick"])])])])}),128))])])])):(k(),l("div",Ue,[s(na,{icon:"warning",title:"项目不存在","sub-title":"抱歉，您访问的项目实践不存在或已被删除"},{extra:c(()=>[s(sa,{type:"success",onClick:a[4]||(a[4]=a=>e.$router.push("/project-practice"))},{default:c(()=>a[22]||(a[22]=[v(" 返回项目实践 ",-1)])),_:1,__:[22]})]),_:1})]))])])}}},[["__scopeId","data-v-29f6de87"]]);export{Fe as default};
