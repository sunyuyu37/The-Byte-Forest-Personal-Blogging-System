/* empty css             *//* empty css                  *//* empty css                        *//* empty css                     *//* empty css                     *//* empty css                  *//* empty css                 */import"./el-tooltip-l0sNRNKZ.js";import{b as e,r as t,w as n,H as a,I as o,a as i,c as r,Q as s,P as l,a6 as u,O as d,K as c,M as m,o as h,aD as f,p as g,al as v,a4 as p,u as y,ay as b,T as w,L as _}from"./vue-B9wWIsxR.js";import{u as M}from"./index-di9GIa25.js";import{d as k,e as S,f as W,h as P,i as x,j as D,k as T,E as j,l as C,s as A,m as E,n as X,o as V,p as I,q as z,r as Y,t as N,u as F,v as H,w as L,x as q,y as O,z as R,A as U,B as J,C as B,D as Q,F as G,G as $,H as K,I as Z}from"./element-plus-CXASJE3V.js";/* empty css                   *//* empty css                    *//* empty css                 *//* empty css                    *//* empty css               */import{a as ee}from"./announcement-C-l9msDL.js";import{_ as te}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./utils-C28rWPR3.js";const ne=43200,ae=Symbol.for("constructDateFrom");function oe(e,t){return"function"==typeof e?e(t):e&&"object"==typeof e&&ae in e?e[ae](t):e instanceof Date?new e.constructor(t):new Date(t)}function ie(e,t){return oe(t||e,e)}let re={};function se(){return re}function le(e,t){var n,a,o,i;const r=se(),s=(null==t?void 0:t.weekStartsOn)??(null==(a=null==(n=null==t?void 0:t.locale)?void 0:n.options)?void 0:a.weekStartsOn)??r.weekStartsOn??(null==(i=null==(o=r.locale)?void 0:o.options)?void 0:i.weekStartsOn)??0,l=ie(e,null==t?void 0:t.in),u=l.getDay(),d=(u<s?7:0)+u-s;return l.setDate(l.getDate()-d),l.setHours(0,0,0,0),l}function ue(e){const t=ie(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function de(e,...t){const n=oe.bind(null,e||t.find(e=>"object"==typeof e));return t.map(n)}function ce(e,t){const n=+ie(e)-+ie(t);return n<0?-1:n>0?1:n}function me(e,t){const n=ie(e,null==t?void 0:t.in);return+function(e,t){const n=ie(e,null==t?void 0:t.in);return n.setHours(23,59,59,999),n}(n,t)===+function(e,t){const n=ie(e,null==t?void 0:t.in),a=n.getMonth();return n.setFullYear(n.getFullYear(),a+1,0),n.setHours(23,59,59,999),n}(n,t)}function he(e,t,n){const[a,o,i]=de(null==n?void 0:n.in,e,e,t),r=ce(o,i),s=Math.abs(function(e,t,n){const[a,o]=de(null==n?void 0:n.in,e,t);return 12*(a.getFullYear()-o.getFullYear())+(a.getMonth()-o.getMonth())}(o,i));if(s<1)return 0;1===o.getMonth()&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-r*s);let l=ce(o,i)===-r;me(a)&&1===s&&1===ce(a,i)&&(l=!1);const u=r*(s-+l);return 0===u?0:u}function fe(e,t,n){const a=function(e,t){return+ie(e)-+ie(t)}(e,t)/1e3;return(o=null==n?void 0:n.roundingMethod,e=>{const t=(o?Math[o]:Math.trunc)(e);return 0===t?0:t})(a);var o}const ge={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function ve(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const pe={date:ve({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:ve({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:ve({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},ye={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function be(e){return(t,n)=>{let a;if("formatting"===((null==n?void 0:n.context)?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,o=(null==n?void 0:n.width)?String(n.width):t;a=e.formattingValues[o]||e.formattingValues[t]}else{const t=e.defaultWidth,o=(null==n?void 0:n.width)?String(n.width):e.defaultWidth;a=e.values[o]||e.values[t]}return a[e.argumentCallback?e.argumentCallback(t):t]}}function we(e){return(t,n={})=>{const a=n.width,o=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],i=t.match(o);if(!i)return null;const r=i[0],s=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(s)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n;return}(s,e=>e.test(r)):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n;return}(s,e=>e.test(r));let u;u=e.valueCallback?e.valueCallback(l):l,u=n.valueCallback?n.valueCallback(u):u;return{value:u,rest:t.slice(r.length)}}}function _e(e){return(t,n={})=>{const a=t.match(e.matchPattern);if(!a)return null;const o=a[0],i=t.match(e.parsePattern);if(!i)return null;let r=e.valueCallback?e.valueCallback(i[0]):i[0];r=n.valueCallback?n.valueCallback(r):r;return{value:r,rest:t.slice(o.length)}}}const Me={code:"en-US",formatDistance:(e,t,n)=>{let a;const o=ge[e];return a="string"==typeof o?o:1===t?o.one:o.other.replace("{{count}}",t.toString()),(null==n?void 0:n.addSuffix)?n.comparison&&n.comparison>0?"in "+a:a+" ago":a},formatLong:pe,formatRelative:(e,t,n,a)=>ye[e],localize:{ordinalNumber:(e,t)=>{const n=Number(e),a=n%100;if(a>20||a<10)switch(a%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:be({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:be({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:be({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:be({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:be({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:_e({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:we({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:we({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:we({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:we({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:we({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function ke(e,t){return function(e,t,n){const a=se(),o=(null==n?void 0:n.locale)??a.locale??Me,i=ce(e,t);if(isNaN(i))throw new RangeError("Invalid time value");const r=Object.assign({},n,{addSuffix:null==n?void 0:n.addSuffix,comparison:i}),[s,l]=de(null==n?void 0:n.in,...i>0?[t,e]:[e,t]),u=fe(l,s),d=(ue(l)-ue(s))/1e3,c=Math.round((u-d)/60);let m;if(c<2)return(null==n?void 0:n.includeSeconds)?u<5?o.formatDistance("lessThanXSeconds",5,r):u<10?o.formatDistance("lessThanXSeconds",10,r):u<20?o.formatDistance("lessThanXSeconds",20,r):u<40?o.formatDistance("halfAMinute",0,r):u<60?o.formatDistance("lessThanXMinutes",1,r):o.formatDistance("xMinutes",1,r):0===c?o.formatDistance("lessThanXMinutes",1,r):o.formatDistance("xMinutes",c,r);if(c<45)return o.formatDistance("xMinutes",c,r);if(c<90)return o.formatDistance("aboutXHours",1,r);if(c<1440){const e=Math.round(c/60);return o.formatDistance("aboutXHours",e,r)}if(c<2520)return o.formatDistance("xDays",1,r);if(c<ne){const e=Math.round(c/1440);return o.formatDistance("xDays",e,r)}if(c<86400)return m=Math.round(c/ne),o.formatDistance("aboutXMonths",m,r);if(m=he(l,s),m<12){const e=Math.round(c/ne);return o.formatDistance("xMonths",e,r)}{const e=m%12,t=Math.trunc(m/12);return e<3?o.formatDistance("aboutXYears",t,r):e<9?o.formatDistance("overXYears",t,r):o.formatDistance("almostXYears",t+1,r)}}(e,function(e){return oe(e,Date.now())}(e),t)}const Se={lessThanXSeconds:{one:"不到 1 秒",other:"不到 {{count}} 秒"},xSeconds:{one:"1 秒",other:"{{count}} 秒"},halfAMinute:"半分钟",lessThanXMinutes:{one:"不到 1 分钟",other:"不到 {{count}} 分钟"},xMinutes:{one:"1 分钟",other:"{{count}} 分钟"},xHours:{one:"1 小时",other:"{{count}} 小时"},aboutXHours:{one:"大约 1 小时",other:"大约 {{count}} 小时"},xDays:{one:"1 天",other:"{{count}} 天"},aboutXWeeks:{one:"大约 1 个星期",other:"大约 {{count}} 个星期"},xWeeks:{one:"1 个星期",other:"{{count}} 个星期"},aboutXMonths:{one:"大约 1 个月",other:"大约 {{count}} 个月"},xMonths:{one:"1 个月",other:"{{count}} 个月"},aboutXYears:{one:"大约 1 年",other:"大约 {{count}} 年"},xYears:{one:"1 年",other:"{{count}} 年"},overXYears:{one:"超过 1 年",other:"超过 {{count}} 年"},almostXYears:{one:"将近 1 年",other:"将近 {{count}} 年"}},We={date:ve({formats:{full:"y'年'M'月'd'日' EEEE",long:"y'年'M'月'd'日'",medium:"yyyy-MM-dd",short:"yy-MM-dd"},defaultWidth:"full"}),time:ve({formats:{full:"zzzz a h:mm:ss",long:"z a h:mm:ss",medium:"a h:mm:ss",short:"a h:mm"},defaultWidth:"full"}),dateTime:ve({formats:{full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},defaultWidth:"full"})};function Pe(e,t,n){const a="eeee p";return function(e,t,n){const[a,o]=de(null==n?void 0:n.in,e,t);return+le(a,n)===+le(o,n)}(e,t,n)?a:e.getTime()>t.getTime()?"'下个'"+a:"'上个'"+a}const xe={lastWeek:Pe,yesterday:"'昨天' p",today:"'今天' p",tomorrow:"'明天' p",nextWeek:Pe,other:"PP p"},De={code:"zh-CN",formatDistance:(e,t,n)=>{let a;const o=Se[e];return a="string"==typeof o?o:1===t?o.one:o.other.replace("{{count}}",String(t)),(null==n?void 0:n.addSuffix)?n.comparison&&n.comparison>0?a+"内":a+"前":a},formatLong:We,formatRelative:(e,t,n,a)=>{const o=xe[e];return"function"==typeof o?o(t,n,a):o},localize:{ordinalNumber:(e,t)=>{const n=Number(e);switch(null==t?void 0:t.unit){case"date":return n.toString()+"日";case"hour":return n.toString()+"时";case"minute":return n.toString()+"分";case"second":return n.toString()+"秒";default:return"第 "+n.toString()}},era:be({values:{narrow:["前","公元"],abbreviated:["前","公元"],wide:["公元前","公元"]},defaultWidth:"wide"}),quarter:be({values:{narrow:["1","2","3","4"],abbreviated:["第一季","第二季","第三季","第四季"],wide:["第一季度","第二季度","第三季度","第四季度"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:be({values:{narrow:["一","二","三","四","五","六","七","八","九","十","十一","十二"],abbreviated:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],wide:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},defaultWidth:"wide"}),day:be({values:{narrow:["日","一","二","三","四","五","六"],short:["日","一","二","三","四","五","六"],abbreviated:["周日","周一","周二","周三","周四","周五","周六"],wide:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]},defaultWidth:"wide"}),dayPeriod:be({values:{narrow:{am:"上",pm:"下",midnight:"凌晨",noon:"午",morning:"早",afternoon:"下午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"},wide:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"}},defaultWidth:"wide",formattingValues:{narrow:{am:"上",pm:"下",midnight:"凌晨",noon:"午",morning:"早",afternoon:"下午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"},wide:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:_e({matchPattern:/^(第\s*)?\d+(日|时|分|秒)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:we({matchPatterns:{narrow:/^(前)/i,abbreviated:/^(前)/i,wide:/^(公元前|公元)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^(前)/i,/^(公元)/i]},defaultParseWidth:"any"}),quarter:we({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^第[一二三四]刻/i,wide:/^第[一二三四]刻钟/i},defaultMatchWidth:"wide",parsePatterns:{any:[/(1|一)/i,/(2|二)/i,/(3|三)/i,/(4|四)/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:we({matchPatterns:{narrow:/^(一|二|三|四|五|六|七|八|九|十[二一])/i,abbreviated:/^(一|二|三|四|五|六|七|八|九|十[二一]|\d|1[12])月/i,wide:/^(一|二|三|四|五|六|七|八|九|十[二一])月/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^一/i,/^二/i,/^三/i,/^四/i,/^五/i,/^六/i,/^七/i,/^八/i,/^九/i,/^十(?!(一|二))/i,/^十一/i,/^十二/i],any:[/^一|1/i,/^二|2/i,/^三|3/i,/^四|4/i,/^五|5/i,/^六|6/i,/^七|7/i,/^八|8/i,/^九|9/i,/^十(?!(一|二))|10/i,/^十一|11/i,/^十二|12/i]},defaultParseWidth:"any"}),day:we({matchPatterns:{narrow:/^[一二三四五六日]/i,short:/^[一二三四五六日]/i,abbreviated:/^周[一二三四五六日]/i,wide:/^星期[一二三四五六日]/i},defaultMatchWidth:"wide",parsePatterns:{any:[/日/i,/一/i,/二/i,/三/i,/四/i,/五/i,/六/i]},defaultParseWidth:"any"}),dayPeriod:we({matchPatterns:{any:/^(上午?|下午?|午夜|[中正]午|早上?|下午|晚上?|凌晨|)/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^上午?/i,pm:/^下午?/i,midnight:/^午夜/i,noon:/^[中正]午/i,morning:/^早上/i,afternoon:/^下午/i,evening:/^晚上?/i,night:/^凌晨/i}},defaultParseWidth:"any"})},options:{weekStartsOn:1,firstWeekContainsDate:4}},Te={class:"announcement-content"},je={key:0,class:"announcement-tabs"},Ce={class:"announcement-item"},Ae={class:"announcement-header"},Ee={class:"announcement-title"},Xe={class:"announcement-meta"},Ve={class:"announcement-time"},Ie={class:"announcement-body"},ze=["innerHTML"],Ye={key:1,class:"single-announcement"},Ne={class:"announcement-item"},Fe={class:"announcement-header"},He={class:"announcement-title"},Le={class:"announcement-meta"},qe={class:"announcement-time"},Oe={class:"announcement-body"},Re=["innerHTML"],Ue={key:2,class:"no-announcements"},Je={class:"dialog-footer"},Be={class:"footer-left"},Qe={class:"footer-right"},Ge=te({__name:"AnnouncementModal",props:{modelValue:{type:Boolean,default:!1},announcements:{type:Array,default:()=>[]}},emits:["update:modelValue","close","allRead"],setup(f,{expose:g,emit:v}){const p=f,y=v,b=e({get:()=>p.modelValue,set:e=>y("update:modelValue",e)}),w=t("0"),_=t(!1),M=t(new Set);n(()=>p.announcements,()=>{w.value="0",M.value.clear()},{immediate:!0});const C=e=>({SYSTEM:"info",MAINTENANCE:"warning",FEATURE:"success",SECURITY:"danger",EVENT:"primary"}[e]||"info"),A=e=>({SYSTEM:"系统",MAINTENANCE:"维护",FEATURE:"功能",SECURITY:"安全",EVENT:"活动"}[e]||"系统"),E=e=>{if(!e)return"";try{return ke(new Date(e),{addSuffix:!0,locale:De})}catch(t){return e}},X=e=>{const t=parseInt(e),n=p.announcements[t];n&&!M.value.has(n.id)&&V(n.id)},V=async e=>{try{await ee.markAsRead(e),M.value.add(e)}catch(t){}},I=async()=>{try{const e=p.announcements.filter(e=>!M.value.has(e.id)).map(e=>e.id);if(e.length>0&&(await ee.markBatchAsRead(e),e.forEach(e=>M.value.add(e))),_.value){const e=(new Date).toDateString();localStorage.setItem("announcement_hide_date",e)}j.success("已标记为已读"),y("allRead"),z()}catch(e){j.error("操作失败，请重试")}},z=()=>{const e=parseInt(w.value),t=p.announcements[e];t&&!M.value.has(t.id)&&V(t.id),y("close"),b.value=!1};return g({shouldShowAnnouncements:()=>localStorage.getItem("announcement_hide_date")!==(new Date).toDateString()}),(e,t)=>{const n=S,g=k,v=W,p=P,y=x,M=D,j=T;return h(),a(j,{modelValue:b.value,"onUpdate:modelValue":t[2]||(t[2]=e=>b.value=e),title:"系统公告",width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,class:"announcement-modal",onClose:z},{footer:o(()=>[i("div",Je,[i("div",Be,[s(y,{modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=e=>_.value=e),label:"今日不再显示",size:"small"},null,8,["modelValue"])]),i("div",Qe,[s(M,{onClick:I,type:"primary",size:"default"},{default:o(()=>t[5]||(t[5]=[m(" 全部已读 ",-1)])),_:1,__:[5]}),s(M,{onClick:z,size:"default"},{default:o(()=>t[6]||(t[6]=[m(" 关闭 ",-1)])),_:1,__:[6]})])])]),default:o(()=>[i("div",Te,[f.announcements.length>1?(h(),r("div",je,[s(v,{modelValue:w.value,"onUpdate:modelValue":t[0]||(t[0]=e=>w.value=e),onTabChange:X},{default:o(()=>[(h(!0),r(l,null,u(f.announcements,(e,r)=>(h(),a(g,{key:e.id,label:e.title,name:r.toString()},{default:o(()=>[i("div",Ce,[i("div",Ae,[i("h3",Ee,d(e.title),1),i("div",Xe,[s(n,{type:C(e.type),size:"small"},{default:o(()=>[m(d(A(e.type)),1)]),_:2},1032,["type"]),"HIGH"===e.priority?(h(),a(n,{key:0,type:"danger",size:"small"},{default:o(()=>t[3]||(t[3]=[m(" 重要 ",-1)])),_:1,__:[3]})):c("",!0),i("span",Ve,d(E(e.createdAt)),1)])]),i("div",Ie,[i("div",{innerHTML:e.content,class:"content-html"},null,8,ze)])])]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])])):1===f.announcements.length?(h(),r("div",Ye,[i("div",Ne,[i("div",Fe,[i("h3",He,d(f.announcements[0].title),1),i("div",Le,[s(n,{type:C(f.announcements[0].type),size:"small"},{default:o(()=>[m(d(A(f.announcements[0].type)),1)]),_:1},8,["type"]),"HIGH"===f.announcements[0].priority?(h(),a(n,{key:0,type:"danger",size:"small"},{default:o(()=>t[4]||(t[4]=[m(" 重要 ",-1)])),_:1,__:[4]})):c("",!0),i("span",qe,d(E(f.announcements[0].createdAt)),1)])]),i("div",Oe,[i("div",{innerHTML:f.announcements[0].content,class:"content-html"},null,8,Re)])])])):(h(),r("div",Ue,[s(p,{description:"暂无新公告"})]))])]),_:1},8,["modelValue"])}}},[["__scopeId","data-v-a43486f8"]]),$e={class:"main-layout"},Ke={class:"header"},Ze={class:"container"},et={class:"header-content"},tt={class:"logo"},nt={class:"nav"},at={class:"user-actions"},ot={class:"search"},it={key:0,class:"user-menu"},rt={class:"user-info"},st={class:"username"},lt={key:1,class:"auth-buttons"},ut={class:"main"},dt={class:"footer"},ct={class:"container"},mt={class:"footer-content"},ht={class:"footer-links"},ft=te({__name:"MainLayout",setup(l){const u=f(),k=b(),S=M(),W=e=>"Home"===e.name?"scale-fade":"ArticleDetail"===e.name?"depth-slide":"Search"===e.name?"quick-slide":["TechShare","LifeEssays","StudyNotes","ProjectPractice","NewsInfo","CompetitionEvents"].includes(e.name)?"card-flip":"smooth-slide",P=t(""),x=t(!1),T=t(!1),te=t([]),ne=t(null),ae=e(()=>{const e=u.path;return"/"===e?"/":e.startsWith("/articles")?"/articles":"/search"===e?"/search":"/about"===e?"/about":(["/tech-share","/life-essays","/study-notes","/project-practice","/news-info","/competition-events"].includes(e),e)}),oe=()=>{P.value.trim()&&k.push({path:"/search",query:{q:P.value.trim()}})},ie=()=>{x.value=!x.value,document.documentElement.classList.toggle("dark",x.value),localStorage.setItem("theme",x.value?"dark":"light")},re=e=>{u.path!==e&&k.push(e)},se=e=>{switch(e){case"profile":k.push("/profile");break;case"admin":k.push("/admin");break;case"logout":S.logout(),j.success("退出登录成功"),k.push("/")}},le=async()=>{try{if(!S.isLoggedIn)return;if(ne.value&&!ne.value.shouldShowAnnouncements())return;const e=await ee.getUnreadAnnouncements();e.data&&e.data.length>0&&(te.value=e.data,T.value=!0)}catch(e){}},ue=()=>{T.value=!1},de=()=>{te.value=[],T.value=!1};return n(()=>S.isLoggedIn,e=>{e&&setTimeout(()=>{le()},1e3)},{immediate:!0}),g(()=>{"dark"===localStorage.getItem("theme")&&(x.value=!0,document.documentElement.classList.add("dark")),S.isLoggedIn&&setTimeout(()=>{le()},1500)}),(e,t)=>{const n=v("router-link"),l=Y,u=z,f=F,g=C,b=E,M=D,k=$,j=Z,ee=K,le=I,ce=v("router-view");return h(),r("div",$e,[i("header",Ke,[i("div",Ze,[i("div",et,[i("div",tt,[s(n,{to:"/"},{default:o(()=>t[4]||(t[4]=[i("h1",{class:"handwriting"},"字节森林",-1)])),_:1,__:[4]})]),i("nav",nt,[s(g,{"default-active":ae.value,mode:"horizontal",ellipsis:!1,"background-color":"transparent","text-color":"#333","active-text-color":"#409eff",onSelect:re},{default:o(()=>[s(u,{index:"/"},{default:o(()=>[s(l,null,{default:o(()=>[s(y(N))]),_:1}),t[5]||(t[5]=i("span",null,"首页",-1))]),_:1,__:[5]}),s(f,{index:"modules"},{title:o(()=>[s(l,null,{default:o(()=>[s(y(J))]),_:1}),t[6]||(t[6]=i("span",null,"模块",-1))]),default:o(()=>[s(u,{index:"/tech-share"},{default:o(()=>[s(l,null,{default:o(()=>[s(y(H))]),_:1}),t[7]||(t[7]=i("span",null,"技术分享",-1))]),_:1,__:[7]}),s(u,{index:"/life-essays"},{default:o(()=>[s(l,null,{default:o(()=>[s(y(L))]),_:1}),t[8]||(t[8]=i("span",null,"生活随笔",-1))]),_:1,__:[8]}),s(u,{index:"/study-notes"},{default:o(()=>[s(l,null,{default:o(()=>[s(y(q))]),_:1}),t[9]||(t[9]=i("span",null,"学习笔记",-1))]),_:1,__:[9]}),s(u,{index:"/project-practice"},{default:o(()=>[s(l,null,{default:o(()=>[s(y(O))]),_:1}),t[10]||(t[10]=i("span",null,"项目实战",-1))]),_:1,__:[10]}),s(u,{index:"/news-info"},{default:o(()=>[s(l,null,{default:o(()=>[s(y(R))]),_:1}),t[11]||(t[11]=i("span",null,"新闻资讯",-1))]),_:1,__:[11]}),s(u,{index:"/competition-events"},{default:o(()=>[s(l,null,{default:o(()=>[s(y(U))]),_:1}),t[12]||(t[12]=i("span",null,"竞赛活动",-1))]),_:1,__:[12]})]),_:1}),s(u,{index:"/articles"},{default:o(()=>[s(l,null,{default:o(()=>[s(y(B))]),_:1}),t[13]||(t[13]=i("span",null,"文章",-1))]),_:1,__:[13]}),s(u,{index:"/search"},{default:o(()=>[s(l,null,{default:o(()=>[s(y(Q))]),_:1}),t[14]||(t[14]=i("span",null,"搜索",-1))]),_:1,__:[14]}),s(u,{index:"/about"},{default:o(()=>[s(l,null,{default:o(()=>[s(y(G))]),_:1}),t[15]||(t[15]=i("span",null,"关于",-1))]),_:1,__:[15]})]),_:1},8,["default-active"])]),i("div",at,[i("div",ot,[s(b,{modelValue:P.value,"onUpdate:modelValue":t[0]||(t[0]=e=>P.value=e),placeholder:"搜索文章...","prefix-icon":y(A),onKeyup:p(oe,["enter"]),clearable:""},null,8,["modelValue","prefix-icon"])]),s(M,{icon:x.value?y(X):y(V),circle:"",onClick:ie},null,8,["icon"]),y(S).isLoggedIn?(h(),r("div",it,[s(le,{onCommand:se},{dropdown:o(()=>[s(ee,null,{default:o(()=>[s(j,{command:"profile"},{default:o(()=>t[16]||(t[16]=[m("个人中心",-1)])),_:1,__:[16]}),y(S).isAdmin?(h(),a(j,{key:0,command:"admin"},{default:o(()=>t[17]||(t[17]=[m("管理后台",-1)])),_:1,__:[17]})):c("",!0),s(j,{divided:"",command:"logout"},{default:o(()=>t[18]||(t[18]=[m("退出登录",-1)])),_:1,__:[18]})]),_:1})]),default:o(()=>{var e,t;return[i("span",rt,[s(k,{src:null==(e=y(S).user)?void 0:e.avatar,size:32},{default:o(()=>{var e,t;return[m(d(null==(t=null==(e=y(S).user)?void 0:e.nickname)?void 0:t.charAt(0)),1)]}),_:1},8,["src"]),i("span",st,d(null==(t=y(S).user)?void 0:t.nickname),1)])]}),_:1})])):(h(),r("div",lt,[s(M,{onClick:t[1]||(t[1]=t=>e.$router.push("/auth/login"))},{default:o(()=>t[19]||(t[19]=[m("登录",-1)])),_:1,__:[19]}),s(M,{type:"primary",onClick:t[2]||(t[2]=t=>e.$router.push("/auth/register"))},{default:o(()=>t[20]||(t[20]=[m("注册",-1)])),_:1,__:[20]})]))])])])]),i("main",ut,[s(ce,null,{default:o(({Component:e,route:t})=>[s(w,{name:W(t),mode:"out-in"},{default:o(()=>[(h(),a(_(e),{key:t.path}))]),_:2},1032,["name"])]),_:1})]),i("footer",dt,[i("div",ct,[i("div",mt,[t[24]||(t[24]=i("p",null,"© 2025 字节森林. All rights reserved.",-1)),i("div",ht,[s(n,{to:"/privacy",class:"footer-link"},{default:o(()=>t[21]||(t[21]=[m("隐私政策",-1)])),_:1,__:[21]}),s(n,{to:"/terms",class:"footer-link"},{default:o(()=>t[22]||(t[22]=[m("使用条款",-1)])),_:1,__:[22]}),s(n,{to:"/contact",class:"footer-link"},{default:o(()=>t[23]||(t[23]=[m("联系我们",-1)])),_:1,__:[23]})])])])]),s(Ge,{ref_key:"announcementModalRef",ref:ne,modelValue:T.value,"onUpdate:modelValue":t[3]||(t[3]=e=>T.value=e),announcements:te.value,onClose:ue,onAllRead:de},null,8,["modelValue","announcements"])])}}},[["__scopeId","data-v-dc9edf3e"]]);export{ft as default};
