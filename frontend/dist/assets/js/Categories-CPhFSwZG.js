/* empty css             *//* empty css                   *//* empty css                   *//* empty css                     *//* empty css                       *//* empty css                 *//* empty css                 *//* empty css                        *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                    *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                  */import{j as e,J as a,k as l,E as t,aS as s,r as o,aT as r,aU as i,a_ as d,K as n,T as u,m as p,a$ as c,b0 as m,aV as _,aW as f,aa as g}from"./element-plus-CXASJE3V.js";import{b as h}from"./positionedConfirm-DdmNknNt.js";import{_ as b}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{r as v,X as V,b as y,p as w,c as C,a as j,Q as I,I as k,J as U,H as x,o as T,M as A,u as Z,K as z,L as M,O}from"./vue-B9wWIsxR.js";const Y={class:"admin-categories"},H={class:"page-header"},R={class:"table-section"},q={class:"category-name"},D={class:"dialog-footer"},E=b({__name:"Categories",setup(b){const E=v(!1),F=v([]),J=v(!1),K=v(!1),L=v(),N=V({id:null,name:"",slug:"",parentId:null,icon:"",description:"",sort:0,status:1}),P={name:[{required:!0,message:"请输入分类名称",trigger:"blur"},{min:1,max:50,message:"分类名称长度在 1 到 50 个字符",trigger:"blur"}],slug:[{required:!0,message:"请输入分类别名",trigger:"blur"},{pattern:/^[a-zA-Z0-9-_]+$/,message:"别名只能包含字母、数字、横线和下划线",trigger:"blur"}]},W=y(()=>N.id?"编辑分类":"新建分类"),X=y(()=>{const e=(a,l=null)=>a.filter(e=>e.parentId===l&&e.id!==N.id).map(l=>({...l,children:e(a,l.id)}));return e(F.value)}),$=()=>{B(),J.value=!0},Q=async()=>{try{await L.value.validate(),K.value=!0,N.id?t.success("更新成功"):t.success("创建成功"),J.value=!1,G()}catch(e){}finally{K.value=!1}},S=()=>{var e;null==(e=L.value)||e.resetFields(),B()},B=()=>{Object.assign(N,{id:null,name:"",slug:"",parentId:null,icon:"",description:"",sort:0,status:1})},G=async()=>{E.value=!0;try{await new Promise(e=>setTimeout(e,500));const e=[{id:1,name:"技术分享",slug:"tech-sharing",parentId:null,icon:"Monitor",description:"技术分享和经验交流",articleCount:15,sort:1,status:1,createdAt:"2025-08-10T10:00:00Z"},{id:2,name:"生活随笔",slug:"life-notes",parentId:null,icon:"Edit",description:"生活感悟和随笔记录",articleCount:8,sort:2,status:1,createdAt:"2025-08-10T10:00:00Z"},{id:3,name:"学习笔记",slug:"study-notes",parentId:null,icon:"Notebook",description:"学习过程中的笔记整理",articleCount:12,sort:3,status:1,createdAt:"2025-08-10T10:00:00Z"},{id:4,name:"项目实战",slug:"project-practice",parentId:null,icon:"Folder",description:"项目开发实战经验",articleCount:9,sort:4,status:1,createdAt:"2025-08-10T10:00:00Z"},{id:5,name:"新闻资讯",slug:"news",parentId:null,icon:"Newspaper",description:"行业新闻和技术资讯",articleCount:6,sort:5,status:1,createdAt:"2025-08-10T10:00:00Z"},{id:6,name:"竞赛活动",slug:"competitions",parentId:null,icon:"Trophy",description:"编程竞赛和技术活动",articleCount:4,sort:6,status:1,createdAt:"2025-08-10T10:00:00Z"}],a=(e,l=null)=>e.filter(e=>e.parentId===l).map(l=>({...l,children:a(e,l.id)}));F.value=a(e)}catch(e){t.error("加载分类列表失败")}finally{E.value=!1}};return w(()=>{G()}),(b,v)=>{const V=o,y=e,w=i,ee=d,ae=s,le=p,te=u,se=c,oe=m,re=f,ie=_,de=n,ne=l,ue=a;return T(),C("div",Y,[j("div",H,[v[10]||(v[10]=j("h1",null,"分类管理",-1)),I(y,{type:"primary",onClick:$},{default:k(()=>[I(V,null,{default:k(()=>[I(Z(r))]),_:1}),v[9]||(v[9]=A(" 新建分类 ",-1))]),_:1,__:[9]})]),j("div",R,[U((T(),x(ae,{data:F.value,style:{width:"100%"},"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}},{default:k(()=>[I(w,{prop:"name",label:"分类名称","min-width":"200"},{default:k(({row:e})=>[j("div",q,[e.icon?(T(),x(V,{key:0,size:16,style:{"margin-right":"8px"}},{default:k(()=>[(T(),x(M(e.icon)))]),_:2},1024)):z("",!0),j("span",null,O(e.name),1)])]),_:1}),I(w,{prop:"slug",label:"别名",width:"150"}),I(w,{prop:"description",label:"描述","min-width":"200"}),I(w,{prop:"articleCount",label:"文章数",width:"100"}),I(w,{prop:"sort",label:"排序",width:"100"}),I(w,{prop:"status",label:"状态",width:"100"},{default:k(({row:e})=>[I(ee,{modelValue:e.status,"onUpdate:modelValue":a=>e.status=a,"active-value":1,"inactive-value":0,onChange:a=>(async e=>{try{t.success("状态更新成功")}catch(a){t.error("状态更新失败"),e.status=1===e.status?0:1}})(e)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),I(w,{prop:"createdAt",label:"创建时间",width:"180"},{default:k(({row:e})=>{return[A(O((a=e.createdAt,a?g(a).format("YYYY-MM-DD HH:mm"):"-")),1)];var a}),_:1}),I(w,{label:"操作",width:"200",fixed:"right"},{default:k(({row:e})=>[I(y,{type:"primary",size:"small",onClick:a=>(e=>{Object.assign(N,{id:e.id,name:e.name,slug:e.slug,parentId:e.parentId,icon:e.icon,description:e.description,sort:e.sort,status:e.status}),J.value=!0})(e)},{default:k(()=>v[11]||(v[11]=[A(" 编辑 ",-1)])),_:2,__:[11]},1032,["onClick"]),I(y,{type:"success",size:"small",onClick:a=>(e=>{B(),N.parentId=e.id,J.value=!0})(e)},{default:k(()=>v[12]||(v[12]=[A(" 添加子分类 ",-1)])),_:2,__:[12]},1032,["onClick"]),I(y,{type:"danger",size:"small",onClick:a=>(async(e,a)=>{if(e.articleCount>0)t.warning("该分类下还有文章，无法删除");else try{await h(e.name,a),t.success("删除成功"),G()}catch(l){"cancel"!==l&&t.error("删除失败")}})(e,a),disabled:e.articleCount>0},{default:k(()=>v[13]||(v[13]=[A(" 删除 ",-1)])),_:2,__:[13]},1032,["onClick","disabled"])]),_:1})]),_:1},8,["data"])),[[ue,E.value]])]),I(ne,{modelValue:J.value,"onUpdate:modelValue":v[8]||(v[8]=e=>J.value=e),title:W.value,width:"600px",onClose:S},{footer:k(()=>[j("div",D,[I(y,{onClick:v[7]||(v[7]=e=>J.value=!1)},{default:k(()=>v[16]||(v[16]=[A("取消",-1)])),_:1,__:[16]}),I(y,{type:"primary",onClick:Q,loading:K.value},{default:k(()=>v[17]||(v[17]=[A(" 确定 ",-1)])),_:1,__:[17]},8,["loading"])])]),default:k(()=>[I(de,{ref_key:"formRef",ref:L,model:N,rules:P,"label-width":"100px"},{default:k(()=>[I(te,{label:"分类名称",prop:"name"},{default:k(()=>[I(le,{modelValue:N.name,"onUpdate:modelValue":v[0]||(v[0]=e=>N.name=e),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),I(te,{label:"分类别名",prop:"slug"},{default:k(()=>[I(le,{modelValue:N.slug,"onUpdate:modelValue":v[1]||(v[1]=e=>N.slug=e),placeholder:"请输入分类别名（用于URL）"},null,8,["modelValue"])]),_:1}),I(te,{label:"父分类",prop:"parentId"},{default:k(()=>[I(se,{modelValue:N.parentId,"onUpdate:modelValue":v[2]||(v[2]=e=>N.parentId=e),data:X.value,props:{label:"name",value:"id"},placeholder:"请选择父分类（可选）",clearable:"","check-strictly":""},null,8,["modelValue","data"])]),_:1}),I(te,{label:"分类图标",prop:"icon"},{default:k(()=>[I(le,{modelValue:N.icon,"onUpdate:modelValue":v[3]||(v[3]=e=>N.icon=e),placeholder:"请输入图标名称"},null,8,["modelValue"])]),_:1}),I(te,{label:"分类描述",prop:"description"},{default:k(()=>[I(le,{modelValue:N.description,"onUpdate:modelValue":v[4]||(v[4]=e=>N.description=e),type:"textarea",rows:3,placeholder:"请输入分类描述"},null,8,["modelValue"])]),_:1}),I(te,{label:"排序",prop:"sort"},{default:k(()=>[I(oe,{modelValue:N.sort,"onUpdate:modelValue":v[5]||(v[5]=e=>N.sort=e),min:0,max:999,placeholder:"数字越小越靠前"},null,8,["modelValue"])]),_:1}),I(te,{label:"状态",prop:"status"},{default:k(()=>[I(ie,{modelValue:N.status,"onUpdate:modelValue":v[6]||(v[6]=e=>N.status=e)},{default:k(()=>[I(re,{label:1},{default:k(()=>v[14]||(v[14]=[A("启用",-1)])),_:1,__:[14]}),I(re,{label:0},{default:k(()=>v[15]||(v[15]=[A("禁用",-1)])),_:1,__:[15]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-44f5c7fa"]]);export{E as default};
