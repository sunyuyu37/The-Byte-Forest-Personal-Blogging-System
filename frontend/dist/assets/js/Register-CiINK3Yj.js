import{X as e,r as s,w as a,b as l,c as r,a as n,D as i,K as o,J as c,Q as t,aj as u,M as m,O as d,aF as p,C as v,ae as w,I as g,al as f,V as k,ay as h,o as y}from"./vue-B9wWIsxR.js";import{u as T,a as x}from"./index-di9GIa25.js";import{F as b}from"./ForestIcons-D1lm84fs.js";import{_ as P}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{E as F}from"./element-plus-CXASJE3V.js";import"./utils-C28rWPR3.js";const _={class:"register-page"},z={class:"form-content"},C={class:"input-section"},B={class:"input-wrapper"},L={class:"input-icon"},j={key:0,class:"validation-icon"},U={key:0,class:"success-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},M={key:1,class:"error-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},V={key:0,class:"error-message"},D={key:1,class:"success-message"},$={class:"input-wrapper"},A={class:"input-icon"},I={key:0,class:"validation-icon"},O={key:0,class:"success-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},R={key:1,class:"error-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},Z={key:0,class:"error-message"},E={key:1,class:"success-message"},S={class:"input-wrapper"},X={class:"input-icon"},J={key:0,class:"validation-icon"},K={key:0,class:"success-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},Q={key:1,class:"error-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},Y={key:0,class:"error-message"},q={key:1,class:"success-message"},G={class:"input-wrapper"},H={class:"input-icon"},N=["type"],W={key:0,class:"error-message"},ee={key:1,class:"password-strength"},se={class:"strength-bar"},ae={class:"input-wrapper"},le={class:"input-icon"},re=["type"],ne={key:0,class:"error-message"},ie={key:1,class:"success-message"},oe={class:"terms-agreement"},ce={class:"agreement-checkbox"},te={class:"agreement-text"},ue={key:0,class:"error-message"},me=["disabled"],de={key:0,class:"button-text forest-text"},pe={key:1,class:"button-loading"},ve={class:"login-link"},we=P({__name:"Register",setup(P){const we=h(),ge=T(),fe=e({username:"",nickname:"",email:"",password:"",confirmPassword:"",agreeToTerms:!1}),ke=e({username:"",nickname:"",email:"",password:"",confirmPassword:"",agreeToTerms:""}),he=e({username:!1,nickname:!1,email:!1,password:!1,confirmPassword:!1}),ye=s(!1),Te=s(!1),xe=s(!1),be=s(!1),Pe=s(!1),Fe=s(!1),_e=s(!1),ze=s(!1),Ce=s(null),Be=e({username:null,email:null,nickname:null});a(()=>fe.nickname,e=>{var s;he.nickname=!1,ke.nickname="",e&&(s=e,Be.nickname&&clearTimeout(Be.nickname),Be.nickname=setTimeout(()=>{s&&s.trim().length>=2&&(he.nickname=!0,ke.nickname="")},400))});const Le=()=>{var e;const s=(null==(e=fe.nickname)?void 0:e.trim())||"";return s?s.length<2?(ke.nickname="昵称至少2个字符",void(he.nickname=!1)):s.length>20?(ke.nickname="昵称最多20个字符",void(he.nickname=!1)):/^[\u4e00-\u9fa5\w-]+$/.test(s)?(ke.nickname="",void(he.nickname=!0)):(ke.nickname="昵称只能包含中文、字母、数字、下划线或连字符",void(he.nickname=!1)):(ke.nickname="请输入昵称",void(he.nickname=!1))},je=l(()=>{const e=fe.password;if(!e)return{width:"0%",class:"",text:""};let s=0,a="",l="";return e.length>=8?s+=2:e.length>=6&&(s+=1),/[a-z]/.test(e)&&(s+=1),/[A-Z]/.test(e)&&(s+=1),/[0-9]/.test(e)&&(s+=1),/[^A-Za-z0-9]/.test(e)&&(s+=1),s<=2?(a="弱",l="weak",{width:"33%",class:l,text:a}):s<=4?(a="中等",l="medium",{width:"66%",class:l,text:a}):(a="强",l="strong",{width:"100%",class:l,text:a})});a(()=>fe.username,e=>{var s;he.username=!1,ke.username="",e&&(s=e,Be.username&&clearTimeout(Be.username),Be.username=setTimeout(async()=>{if(s&&s.length>=3)try{(await x.checkUsername(s)).data?(he.username=!0,ke.username=""):(he.username=!1,ke.username="用户名已被使用")}catch(e){he.username=!1,ke.username="检查用户名失败"}},500))}),a(()=>fe.email,e=>{var s;he.email=!1,ke.email="",e&&(s=e,Be.email&&clearTimeout(Be.email),Be.email=setTimeout(async()=>{if(s&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s))try{(await x.checkEmail(s)).data?(he.email=!0,ke.email=""):(he.email=!1,ke.email="邮箱已被注册")}catch(e){he.email=!1,ke.email="检查邮箱失败"}},500))}),a(()=>fe.password,()=>{he.password=!1,ke.password="",fe.confirmPassword&&De()}),a(()=>fe.confirmPassword,()=>{De()});const Ue=()=>{fe.username.trim()?fe.username.length<3?(ke.username="用户名至少3个字符",he.username=!1):fe.username.length>20?(ke.username="用户名最多20个字符",he.username=!1):/^[a-zA-Z0-9_\u4e00-\u9fa5]+$/.test(fe.username)||(ke.username="用户名只能包含字母、数字、下划线和中文",he.username=!1):(ke.username="请输入用户名",he.username=!1)},Me=()=>{fe.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(fe.email)||(ke.email="邮箱格式不正确",he.email=!1):(ke.email="请输入邮箱地址",he.email=!1)},Ve=()=>{fe.password?fe.password.length<6?(ke.password="密码至少6个字符",he.password=!1):fe.password.length>50?(ke.password="密码最多50个字符",he.password=!1):(ke.password="",he.password="weak"!==je.value.class):(ke.password="请输入密码",he.password=!1)},De=()=>{fe.confirmPassword?fe.password!==fe.confirmPassword?(ke.confirmPassword="两次输入的密码不一致",he.confirmPassword=!1):(ke.confirmPassword="",he.confirmPassword=!0):(ke.confirmPassword="请确认密码",he.confirmPassword=!1)},$e=async()=>{var e,s,a,l,r;if(Ue(),Le(),Me(),Ve(),De(),fe.agreeToTerms?ke.agreeToTerms="":ke.agreeToTerms="请同意服务条款和隐私政策",!Object.values(ke).some(e=>e)&&Object.values(he).every(e=>e)&&fe.agreeToTerms){ye.value=!0;try{let l;try{l=await ge.register({username:fe.username,nickname:fe.nickname,email:fe.email,password:fe.password})}catch(n){const r=(null==(s=null==(e=null==n?void 0:n.response)?void 0:e.data)?void 0:s.message)||(null==n?void 0:n.message)||"",i=/Unrecognized field|Unknown property|无法识别的字段|未知属性/.test(String(r));if(400!==(null==(a=null==n?void 0:n.response)?void 0:a.status)||!i)throw n;l=await ge.register({username:fe.username,email:fe.email,password:fe.password}),F.info("后端暂未支持注册时设置昵称，已先完成注册，您可在个人中心修改昵称")}200===l.code?(F.success("注册成功！欢迎加入字节森林"),we.push("/auth/login")):F.error(l.message||"注册失败")}catch(i){(null==(r=null==(l=i.response)?void 0:l.data)?void 0:r.message)?F.error(i.response.data.message):i.message?F.error(i.message):F.error("注册失败，请检查网络连接")}finally{ye.value=!1}}else F.warning("请填写完整且正确的信息")},Ae=e=>{const s=e.currentTarget,a=Ce.value,l=s.getBoundingClientRect(),r=Math.max(l.width,l.height),n=e.clientX-l.left-r/2,i=e.clientY-l.top-r/2;a&&(a.style.width=a.style.height=r+"px",a.style.left=n+"px",a.style.top=i+"px",a.classList.add("active"),setTimeout(()=>{a.classList.remove("active")},600))};return(e,s)=>{const a=f("router-link");return y(),r("div",_,[n("form",{onSubmit:k($e,["prevent"]),class:"register-form"},[n("div",z,[n("div",C,[n("div",{class:i(["input-group",{focused:be.value,error:ke.username,success:he.username}])},[n("div",B,[n("div",L,[t(b,{name:"leaf",color:"currentColor",size:20})]),c(n("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>fe.username=e),type:"text",placeholder:"用户名",onFocus:s[1]||(s[1]=e=>be.value=!0),onBlur:s[2]||(s[2]=e=>{be.value=!1,Ue()}),class:i({error:ke.username,success:he.username})},null,34),[[u,fe.username]]),he.username||ke.username?(y(),r("div",j,[he.username?(y(),r("svg",U,s[18]||(s[18]=[n("path",{d:"M9 16.17l-3.59-3.58L4 14l5 5 12-12-1.41-1.42L9 16.17z",fill:"#78FFD6"},null,-1)]))):(y(),r("svg",M,s[19]||(s[19]=[n("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z",fill:"#FF8C42"},null,-1)])))])):o("",!0),s[20]||(s[20]=n("div",{class:"focus-line"},null,-1))]),ke.username?(y(),r("div",V,[s[21]||(s[21]=n("div",{class:"error-icon"},"⚠",-1)),m(" "+d(ke.username),1)])):he.username?(y(),r("div",D,s[22]||(s[22]=[n("div",{class:"success-icon"},"✓",-1),m(" 用户名可用 ",-1)]))):o("",!0)],2),n("div",{class:i(["input-group",{focused:Pe.value,error:ke.nickname,success:he.nickname}])},[n("div",$,[n("div",A,[t(b,{name:"sapling",color:"currentColor",size:20})]),c(n("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>fe.nickname=e),type:"text",placeholder:"昵称",onFocus:s[4]||(s[4]=e=>Pe.value=!0),onBlur:s[5]||(s[5]=e=>{Pe.value=!1,Le()}),class:i({error:ke.nickname,success:he.nickname})},null,34),[[u,fe.nickname]]),he.nickname||ke.nickname?(y(),r("div",I,[he.nickname?(y(),r("svg",O,s[23]||(s[23]=[n("path",{d:"M9 16.17l-3.59-3.58L4 14l5 5 12-12-1.41-1.42L9 16.17z",fill:"#78FFD6"},null,-1)]))):(y(),r("svg",R,s[24]||(s[24]=[n("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z",fill:"#FF8C42"},null,-1)])))])):o("",!0),s[25]||(s[25]=n("div",{class:"focus-line"},null,-1))]),ke.nickname?(y(),r("div",Z,[s[26]||(s[26]=n("div",{class:"error-icon"},"⚠",-1)),m(" "+d(ke.nickname),1)])):he.nickname?(y(),r("div",E,s[27]||(s[27]=[n("div",{class:"success-icon"},"✓",-1),m(" 昵称可用 ",-1)]))):o("",!0)],2),n("div",{class:i(["input-group",{focused:Fe.value,error:ke.email,success:he.email}])},[n("div",S,[n("div",X,[t(b,{name:"leaf",color:"currentColor",size:20})]),c(n("input",{"onUpdate:modelValue":s[6]||(s[6]=e=>fe.email=e),type:"email",placeholder:"邮箱地址",onFocus:s[7]||(s[7]=e=>Fe.value=!0),onBlur:s[8]||(s[8]=e=>{Fe.value=!1,Me()}),class:i({error:ke.email,success:he.email})},null,34),[[u,fe.email]]),he.email||ke.email?(y(),r("div",J,[he.email?(y(),r("svg",K,s[28]||(s[28]=[n("path",{d:"M9 16.17l-3.59-3.58L4 14l5 5 12-12-1.41-1.42L9 16.17z",fill:"#78FFD6"},null,-1)]))):(y(),r("svg",Q,s[29]||(s[29]=[n("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z",fill:"#FF8C42"},null,-1)])))])):o("",!0),s[30]||(s[30]=n("div",{class:"focus-line"},null,-1))]),ke.email?(y(),r("div",Y,[s[31]||(s[31]=n("div",{class:"error-icon"},"⚠",-1)),m(" "+d(ke.email),1)])):he.email?(y(),r("div",q,s[32]||(s[32]=[n("div",{class:"success-icon"},"✓",-1),m(" 邮箱格式正确 ",-1)]))):o("",!0)],2),n("div",{class:i(["input-group",{focused:_e.value,error:ke.password,success:he.password}])},[n("div",G,[n("div",H,[t(b,{name:"tree-lock",color:"currentColor",size:20})]),c(n("input",{"onUpdate:modelValue":s[9]||(s[9]=e=>fe.password=e),type:Te.value?"text":"password",placeholder:"密码",onFocus:s[10]||(s[10]=e=>_e.value=!0),onBlur:s[11]||(s[11]=e=>{_e.value=!1,Ve()}),class:i({error:ke.password,success:he.password})},null,42,N),[[p,fe.password]]),n("button",{type:"button",class:"password-toggle",onClick:s[12]||(s[12]=e=>Te.value=!Te.value)},[t(b,{name:Te.value?"forest":"leaf",color:"currentColor",size:20},null,8,["name"])]),s[33]||(s[33]=n("div",{class:"focus-line"},null,-1))]),ke.password?(y(),r("div",W,[s[34]||(s[34]=n("div",{class:"error-icon"},"⚠",-1)),m(" "+d(ke.password),1)])):o("",!0),fe.password?(y(),r("div",ee,[s[35]||(s[35]=n("div",{class:"strength-label"},"密码强度：",-1)),n("div",se,[n("div",{class:i(["strength-fill",je.value.class]),style:v({width:je.value.width})},null,6)]),n("div",{class:i(["strength-text",je.value.class])},d(je.value.text),3)])):o("",!0)],2),n("div",{class:i(["input-group",{focused:ze.value,error:ke.confirmPassword,success:he.confirmPassword}])},[n("div",ae,[n("div",le,[t(b,{name:"tree-lock",color:"currentColor",size:20})]),c(n("input",{"onUpdate:modelValue":s[13]||(s[13]=e=>fe.confirmPassword=e),type:xe.value?"text":"password",placeholder:"确认密码",onFocus:s[14]||(s[14]=e=>ze.value=!0),onBlur:s[15]||(s[15]=e=>{ze.value=!1,De()}),class:i({error:ke.confirmPassword,success:he.confirmPassword})},null,42,re),[[p,fe.confirmPassword]]),n("button",{type:"button",class:"password-toggle",onClick:s[16]||(s[16]=e=>xe.value=!xe.value)},[t(b,{name:xe.value?"forest":"leaf",color:"currentColor",size:20},null,8,["name"])]),s[36]||(s[36]=n("div",{class:"focus-line"},null,-1))]),ke.confirmPassword?(y(),r("div",ne,[s[37]||(s[37]=n("div",{class:"error-icon"},"⚠",-1)),m(" "+d(ke.confirmPassword),1)])):he.confirmPassword?(y(),r("div",ie,s[38]||(s[38]=[n("div",{class:"success-icon"},"✓",-1),m(" 密码确认一致 ",-1)]))):o("",!0)],2)]),n("div",oe,[n("label",ce,[c(n("input",{type:"checkbox","onUpdate:modelValue":s[17]||(s[17]=e=>fe.agreeToTerms=e)},null,512),[[w,fe.agreeToTerms]]),s[43]||(s[43]=n("span",{class:"custom-checkbox"},null,-1)),n("span",te,[s[41]||(s[41]=m(" 我已阅读并同意 ",-1)),t(a,{to:"/terms",class:"terms-link"},{default:g(()=>s[39]||(s[39]=[m("《服务条款》",-1)])),_:1,__:[39]}),s[42]||(s[42]=m(" 和 ",-1)),t(a,{to:"/privacy",class:"privacy-link"},{default:g(()=>s[40]||(s[40]=[m("《隐私政策》",-1)])),_:1,__:[40]})])]),ke.agreeToTerms?(y(),r("div",ue,[s[44]||(s[44]=n("div",{class:"error-icon"},"⚠",-1)),m(" "+d(ke.agreeToTerms),1)])):o("",!0)]),n("button",{type:"submit",class:i(["register-button",{loading:ye.value}]),disabled:ye.value||!fe.agreeToTerms,onClick:Ae},[ye.value?(y(),r("div",pe,s[45]||(s[45]=[n("div",{class:"vine-loader"},null,-1),n("span",null,"种植中...",-1)]))):(y(),r("span",de,"踏入字节森林")),n("div",{class:"button-ripple",ref_key:"rippleRef",ref:Ce},null,512)],10,me),n("div",ve,[s[47]||(s[47]=n("span",null,"已经有账户了？",-1)),t(a,{to:"/auth/login",class:"login-vine"},{default:g(()=>s[46]||(s[46]=[m(" 返回森林 ",-1),n("div",{class:"vine-growth"},null,-1)])),_:1,__:[46]})])])],32)])}}},[["__scopeId","data-v-19ea235d"]]);export{we as default};
